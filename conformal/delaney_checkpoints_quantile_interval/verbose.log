Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
  )
)
Number of parameters = 354,900
Epoch 0
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
  )
)
Number of parameters = 354,900
Epoch 0
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
  )
)
Number of parameters = 354,900
Epoch 0
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 2.549769
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.489253
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 3.384753
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 1.917802
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 3.092881
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 1.603057
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.052109
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.720201
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 1.332359
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 2.273981
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.049300
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.311640
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.186127
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 2.249553
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3250e-02, PNorm = 34.6128, GNorm = 0.5350, lr_0 = 3.2059e-04
Loss = 1.3184e-01, PNorm = 34.6136, GNorm = 5.6786, lr_0 = 3.1913e-04
Validation rmse = 1.207856
Epoch 15
Loss = 8.9066e-02, PNorm = 34.6239, GNorm = 1.6323, lr_0 = 3.0488e-04
Validation rmse = 1.733204
Epoch 16
Loss = 9.0441e-02, PNorm = 34.6353, GNorm = 1.3797, lr_0 = 2.8994e-04
Loss = 9.6448e-02, PNorm = 34.6485, GNorm = 2.5399, lr_0 = 2.7699e-04
Validation rmse = 2.365901
Epoch 17
Loss = 8.4414e-02, PNorm = 34.6618, GNorm = 0.4887, lr_0 = 2.6341e-04
Loss = 8.3445e-02, PNorm = 34.6692, GNorm = 0.9714, lr_0 = 2.5165e-04
Validation rmse = 1.341160
Epoch 18
Loss = 9.1656e-02, PNorm = 34.6825, GNorm = 1.3956, lr_0 = 2.3931e-04
Loss = 8.9483e-02, PNorm = 34.6920, GNorm = 1.3299, lr_0 = 2.2863e-04
Validation rmse = 1.934346
Epoch 19
Loss = 8.2830e-02, PNorm = 34.6991, GNorm = 0.5033, lr_0 = 2.1742e-04
Loss = 7.3895e-02, PNorm = 34.7038, GNorm = 0.3148, lr_0 = 2.0771e-04
Loss = 6.4742e-02, PNorm = 34.7042, GNorm = 0.3787, lr_0 = 2.0676e-04
Validation rmse = 1.380872
Epoch 20
Loss = 7.1475e-02, PNorm = 34.7112, GNorm = 0.3413, lr_0 = 1.9753e-04
Validation rmse = 1.087166
Epoch 21
Loss = 6.0695e-02, PNorm = 34.7171, GNorm = 0.2360, lr_0 = 1.8785e-04
Loss = 6.7627e-02, PNorm = 34.7235, GNorm = 0.2438, lr_0 = 1.7946e-04
Validation rmse = 1.079291
Epoch 22
Loss = 6.9953e-02, PNorm = 34.7302, GNorm = 0.4184, lr_0 = 1.7066e-04
Loss = 6.3349e-02, PNorm = 34.7351, GNorm = 1.0644, lr_0 = 1.6304e-04
Validation rmse = 0.929263
Epoch 23
Loss = 6.4619e-02, PNorm = 34.7413, GNorm = 0.2491, lr_0 = 1.5505e-04
Loss = 6.3794e-02, PNorm = 34.7459, GNorm = 0.7028, lr_0 = 1.4813e-04
Validation rmse = 0.987878
Epoch 24
Loss = 6.2509e-02, PNorm = 34.7519, GNorm = 0.7610, lr_0 = 1.4087e-04
Loss = 6.4250e-02, PNorm = 34.7570, GNorm = 0.4385, lr_0 = 1.3458e-04
Validation rmse = 0.719388
Epoch 25
Loss = 6.7614e-02, PNorm = 34.7613, GNorm = 0.3463, lr_0 = 1.2857e-04
Validation rmse = 0.997784
Epoch 26
Loss = 7.0589e-02, PNorm = 34.7659, GNorm = 1.1023, lr_0 = 1.2226e-04
Loss = 5.9533e-02, PNorm = 34.7708, GNorm = 0.3875, lr_0 = 1.1680e-04
Validation rmse = 0.812639
Epoch 27
Loss = 5.2986e-02, PNorm = 34.7740, GNorm = 0.2553, lr_0 = 1.1108e-04
Loss = 5.8897e-02, PNorm = 34.7768, GNorm = 0.3707, lr_0 = 1.0612e-04
Validation rmse = 0.595373
Epoch 28
Loss = 6.1285e-02, PNorm = 34.7810, GNorm = 0.3890, lr_0 = 1.0092e-04
Loss = 6.2371e-02, PNorm = 34.7848, GNorm = 0.8759, lr_0 = 1.0000e-04
Validation rmse = 0.672726
Epoch 29
Loss = 6.3732e-02, PNorm = 34.7870, GNorm = 0.4068, lr_0 = 1.0000e-04
Loss = 6.7032e-02, PNorm = 34.7900, GNorm = 0.3719, lr_0 = 1.0000e-04
Validation rmse = 0.590836
Model 0 best validation rmse = 0.590836 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 2.549769
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.489253
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 3.384753
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 1.917802
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 3.092881
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 1.603057
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.052109
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.720201
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 1.332359
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 2.273981
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.049300
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.311640
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.186127
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 2.249553
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3250e-02, PNorm = 34.6128, GNorm = 0.5350, lr_0 = 3.2059e-04
Loss = 1.3184e-01, PNorm = 34.6136, GNorm = 5.6786, lr_0 = 3.1913e-04
Validation rmse = 1.207856
Epoch 15
Loss = 8.9066e-02, PNorm = 34.6239, GNorm = 1.6323, lr_0 = 3.0488e-04
Validation rmse = 1.733204
Epoch 16
Loss = 9.0441e-02, PNorm = 34.6353, GNorm = 1.3797, lr_0 = 2.8994e-04
Loss = 9.6448e-02, PNorm = 34.6485, GNorm = 2.5399, lr_0 = 2.7699e-04
Validation rmse = 2.365901
Epoch 17
Loss = 8.4414e-02, PNorm = 34.6618, GNorm = 0.4887, lr_0 = 2.6341e-04
Loss = 8.3445e-02, PNorm = 34.6692, GNorm = 0.9714, lr_0 = 2.5165e-04
Validation rmse = 1.341160
Epoch 18
Loss = 9.1656e-02, PNorm = 34.6825, GNorm = 1.3956, lr_0 = 2.3931e-04
Loss = 8.9483e-02, PNorm = 34.6920, GNorm = 1.3299, lr_0 = 2.2863e-04
Validation rmse = 1.934346
Epoch 19
Loss = 8.2830e-02, PNorm = 34.6991, GNorm = 0.5033, lr_0 = 2.1742e-04
Loss = 7.3895e-02, PNorm = 34.7038, GNorm = 0.3148, lr_0 = 2.0771e-04
Loss = 6.4742e-02, PNorm = 34.7042, GNorm = 0.3787, lr_0 = 2.0676e-04
Validation rmse = 1.380872
Epoch 20
Loss = 7.1475e-02, PNorm = 34.7112, GNorm = 0.3413, lr_0 = 1.9753e-04
Validation rmse = 1.087166
Epoch 21
Loss = 6.0695e-02, PNorm = 34.7171, GNorm = 0.2360, lr_0 = 1.8785e-04
Loss = 6.7627e-02, PNorm = 34.7235, GNorm = 0.2438, lr_0 = 1.7946e-04
Validation rmse = 1.079291
Epoch 22
Loss = 6.9953e-02, PNorm = 34.7302, GNorm = 0.4184, lr_0 = 1.7066e-04
Loss = 6.3349e-02, PNorm = 34.7351, GNorm = 1.0644, lr_0 = 1.6304e-04
Validation rmse = 0.929263
Epoch 23
Loss = 6.4619e-02, PNorm = 34.7413, GNorm = 0.2491, lr_0 = 1.5505e-04
Loss = 6.3794e-02, PNorm = 34.7459, GNorm = 0.7028, lr_0 = 1.4813e-04
Validation rmse = 0.987878
Epoch 24
Loss = 6.2509e-02, PNorm = 34.7519, GNorm = 0.7610, lr_0 = 1.4087e-04
Loss = 6.4250e-02, PNorm = 34.7570, GNorm = 0.4385, lr_0 = 1.3458e-04
Validation rmse = 0.719388
Epoch 25
Loss = 6.7614e-02, PNorm = 34.7613, GNorm = 0.3463, lr_0 = 1.2857e-04
Validation rmse = 0.997784
Epoch 26
Loss = 7.0589e-02, PNorm = 34.7659, GNorm = 1.1023, lr_0 = 1.2226e-04
Loss = 5.9533e-02, PNorm = 34.7708, GNorm = 0.3875, lr_0 = 1.1680e-04
Validation rmse = 0.812639
Epoch 27
Loss = 5.2986e-02, PNorm = 34.7740, GNorm = 0.2553, lr_0 = 1.1108e-04
Loss = 5.8897e-02, PNorm = 34.7768, GNorm = 0.3707, lr_0 = 1.0612e-04
Validation rmse = 0.595373
Epoch 28
Loss = 6.1285e-02, PNorm = 34.7810, GNorm = 0.3890, lr_0 = 1.0092e-04
Loss = 6.2371e-02, PNorm = 34.7848, GNorm = 0.8759, lr_0 = 1.0000e-04
Validation rmse = 0.672726
Epoch 29
Loss = 6.3732e-02, PNorm = 34.7870, GNorm = 0.4068, lr_0 = 1.0000e-04
Loss = 6.7032e-02, PNorm = 34.7900, GNorm = 0.3719, lr_0 = 1.0000e-04
Validation rmse = 0.590836
Model 0 best validation rmse = 0.590836 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 2.549769
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.489253
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 3.384753
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 1.917802
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 3.092881
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 1.603057
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.052109
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.720201
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 1.332359
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 2.273981
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.049300
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.311640
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.186127
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 2.249553
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3250e-02, PNorm = 34.6128, GNorm = 0.5350, lr_0 = 3.2059e-04
Loss = 1.3184e-01, PNorm = 34.6136, GNorm = 5.6786, lr_0 = 3.1913e-04
Validation rmse = 1.207856
Epoch 15
Loss = 8.9066e-02, PNorm = 34.6239, GNorm = 1.6323, lr_0 = 3.0488e-04
Validation rmse = 1.733204
Epoch 16
Loss = 9.0441e-02, PNorm = 34.6353, GNorm = 1.3797, lr_0 = 2.8994e-04
Loss = 9.6448e-02, PNorm = 34.6485, GNorm = 2.5399, lr_0 = 2.7699e-04
Validation rmse = 2.365901
Epoch 17
Loss = 8.4414e-02, PNorm = 34.6618, GNorm = 0.4887, lr_0 = 2.6341e-04
Loss = 8.3445e-02, PNorm = 34.6692, GNorm = 0.9714, lr_0 = 2.5165e-04
Validation rmse = 1.341160
Epoch 18
Loss = 9.1656e-02, PNorm = 34.6825, GNorm = 1.3956, lr_0 = 2.3931e-04
Loss = 8.9483e-02, PNorm = 34.6920, GNorm = 1.3299, lr_0 = 2.2863e-04
Validation rmse = 1.934346
Epoch 19
Loss = 8.2830e-02, PNorm = 34.6991, GNorm = 0.5033, lr_0 = 2.1742e-04
Loss = 7.3895e-02, PNorm = 34.7038, GNorm = 0.3148, lr_0 = 2.0771e-04
Loss = 6.4742e-02, PNorm = 34.7042, GNorm = 0.3787, lr_0 = 2.0676e-04
Validation rmse = 1.380872
Epoch 20
Loss = 7.1475e-02, PNorm = 34.7112, GNorm = 0.3413, lr_0 = 1.9753e-04
Validation rmse = 1.087166
Epoch 21
Loss = 6.0695e-02, PNorm = 34.7171, GNorm = 0.2360, lr_0 = 1.8785e-04
Loss = 6.7627e-02, PNorm = 34.7235, GNorm = 0.2438, lr_0 = 1.7946e-04
Validation rmse = 1.079291
Epoch 22
Loss = 6.9953e-02, PNorm = 34.7302, GNorm = 0.4184, lr_0 = 1.7066e-04
Loss = 6.3349e-02, PNorm = 34.7351, GNorm = 1.0644, lr_0 = 1.6304e-04
Validation rmse = 0.929263
Epoch 23
Loss = 6.4619e-02, PNorm = 34.7413, GNorm = 0.2491, lr_0 = 1.5505e-04
Loss = 6.3794e-02, PNorm = 34.7459, GNorm = 0.7028, lr_0 = 1.4813e-04
Validation rmse = 0.987863
Epoch 24
Loss = 6.2509e-02, PNorm = 34.7519, GNorm = 0.7610, lr_0 = 1.4087e-04
Loss = 6.4253e-02, PNorm = 34.7570, GNorm = 0.4385, lr_0 = 1.3458e-04
Validation rmse = 0.719592
Epoch 25
Loss = 6.7608e-02, PNorm = 34.7613, GNorm = 0.3463, lr_0 = 1.2857e-04
Validation rmse = 0.997115
Epoch 26
Loss = 7.0585e-02, PNorm = 34.7659, GNorm = 1.1024, lr_0 = 1.2226e-04
Loss = 5.9531e-02, PNorm = 34.7708, GNorm = 0.3880, lr_0 = 1.1680e-04
Validation rmse = 0.811691
Epoch 27
Loss = 5.2984e-02, PNorm = 34.7740, GNorm = 0.2555, lr_0 = 1.1108e-04
Loss = 5.8900e-02, PNorm = 34.7768, GNorm = 0.3693, lr_0 = 1.0612e-04
Validation rmse = 0.594519
Epoch 28
Loss = 6.1323e-02, PNorm = 34.7811, GNorm = 0.3891, lr_0 = 1.0092e-04
Loss = 6.2389e-02, PNorm = 34.7849, GNorm = 0.8760, lr_0 = 1.0000e-04
Validation rmse = 0.669355
Epoch 29
Loss = 6.3849e-02, PNorm = 34.7870, GNorm = 0.4076, lr_0 = 1.0000e-04
Loss = 6.7096e-02, PNorm = 34.7900, GNorm = 0.4229, lr_0 = 1.0000e-04
Validation rmse = 0.624030
Model 0 best validation rmse = 0.594519 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 2.549769
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.489253
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 3.384753
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 1.917802
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 3.092881
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 1.603057
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.052109
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.720201
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 1.332359
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 2.273981
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.049300
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.311640
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.186127
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 2.249553
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3250e-02, PNorm = 34.6128, GNorm = 0.5350, lr_0 = 3.2059e-04
Loss = 1.3184e-01, PNorm = 34.6136, GNorm = 5.6786, lr_0 = 3.1913e-04
Validation rmse = 1.207856
Epoch 15
Loss = 8.9066e-02, PNorm = 34.6239, GNorm = 1.6323, lr_0 = 3.0488e-04
Validation rmse = 1.733204
Epoch 16
Loss = 9.0441e-02, PNorm = 34.6353, GNorm = 1.3797, lr_0 = 2.8994e-04
Loss = 9.6448e-02, PNorm = 34.6485, GNorm = 2.5399, lr_0 = 2.7699e-04
Validation rmse = 2.365901
Epoch 17
Loss = 8.4414e-02, PNorm = 34.6618, GNorm = 0.4887, lr_0 = 2.6341e-04
Loss = 8.3445e-02, PNorm = 34.6692, GNorm = 0.9714, lr_0 = 2.5165e-04
Validation rmse = 1.341160
Epoch 18
Loss = 9.1656e-02, PNorm = 34.6825, GNorm = 1.3956, lr_0 = 2.3931e-04
Loss = 8.9483e-02, PNorm = 34.6920, GNorm = 1.3299, lr_0 = 2.2863e-04
Validation rmse = 1.934346
Epoch 19
Loss = 8.2830e-02, PNorm = 34.6991, GNorm = 0.5033, lr_0 = 2.1742e-04
Loss = 7.3895e-02, PNorm = 34.7038, GNorm = 0.3148, lr_0 = 2.0771e-04
Loss = 6.4742e-02, PNorm = 34.7042, GNorm = 0.3787, lr_0 = 2.0676e-04
Validation rmse = 1.380872
Epoch 20
Loss = 7.1475e-02, PNorm = 34.7112, GNorm = 0.3413, lr_0 = 1.9753e-04
Validation rmse = 1.087166
Epoch 21
Loss = 6.0695e-02, PNorm = 34.7171, GNorm = 0.2360, lr_0 = 1.8785e-04
Loss = 6.7627e-02, PNorm = 34.7235, GNorm = 0.2438, lr_0 = 1.7946e-04
Validation rmse = 1.079291
Epoch 22
Loss = 6.9953e-02, PNorm = 34.7302, GNorm = 0.4184, lr_0 = 1.7066e-04
Loss = 6.3349e-02, PNorm = 34.7351, GNorm = 1.0644, lr_0 = 1.6304e-04
Validation rmse = 0.929263
Epoch 23
Loss = 6.4619e-02, PNorm = 34.7413, GNorm = 0.2491, lr_0 = 1.5505e-04
Loss = 6.3794e-02, PNorm = 34.7459, GNorm = 0.7028, lr_0 = 1.4813e-04
Validation rmse = 0.987878
Epoch 24
Loss = 6.2509e-02, PNorm = 34.7519, GNorm = 0.7610, lr_0 = 1.4087e-04
Loss = 6.4250e-02, PNorm = 34.7570, GNorm = 0.4385, lr_0 = 1.3458e-04
Validation rmse = 0.719388
Epoch 25
Loss = 6.7614e-02, PNorm = 34.7613, GNorm = 0.3463, lr_0 = 1.2857e-04
Validation rmse = 0.997784
Epoch 26
Loss = 7.0589e-02, PNorm = 34.7659, GNorm = 1.1023, lr_0 = 1.2226e-04
Loss = 5.9533e-02, PNorm = 34.7708, GNorm = 0.3875, lr_0 = 1.1680e-04
Validation rmse = 0.812639
Epoch 27
Loss = 5.2986e-02, PNorm = 34.7740, GNorm = 0.2553, lr_0 = 1.1108e-04
Loss = 5.8897e-02, PNorm = 34.7768, GNorm = 0.3707, lr_0 = 1.0612e-04
Validation rmse = 0.595373
Epoch 28
Loss = 6.1285e-02, PNorm = 34.7810, GNorm = 0.3890, lr_0 = 1.0092e-04
Loss = 6.2371e-02, PNorm = 34.7848, GNorm = 0.8759, lr_0 = 1.0000e-04
Validation rmse = 0.672726
Epoch 29
Loss = 6.3732e-02, PNorm = 34.7870, GNorm = 0.4068, lr_0 = 1.0000e-04
Loss = 6.7032e-02, PNorm = 34.7900, GNorm = 0.3719, lr_0 = 1.0000e-04
Validation rmse = 0.590836
Model 0 best validation rmse = 0.590836 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 3.633698
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.889111
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 2.628384
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 2.374908
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 2.477306
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 2.093155
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.154187
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.757260
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 2.000148
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 1.913373
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.569437
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.559674
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.481722
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 1.968795
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3250e-02, PNorm = 34.6128, GNorm = 0.5350, lr_0 = 3.2059e-04
Loss = 1.3184e-01, PNorm = 34.6136, GNorm = 5.6786, lr_0 = 3.1913e-04
Validation rmse = 1.512706
Epoch 15
Loss = 8.9066e-02, PNorm = 34.6239, GNorm = 1.6323, lr_0 = 3.0488e-04
Validation rmse = 1.884779
Epoch 16
Loss = 9.0441e-02, PNorm = 34.6353, GNorm = 1.3797, lr_0 = 2.8994e-04
Loss = 9.6448e-02, PNorm = 34.6485, GNorm = 2.5399, lr_0 = 2.7699e-04
Validation rmse = 1.940334
Epoch 17
Loss = 8.4414e-02, PNorm = 34.6618, GNorm = 0.4887, lr_0 = 2.6341e-04
Loss = 8.3445e-02, PNorm = 34.6692, GNorm = 0.9714, lr_0 = 2.5165e-04
Validation rmse = 1.585641
Epoch 18
Loss = 9.1656e-02, PNorm = 34.6825, GNorm = 1.3956, lr_0 = 2.3931e-04
Loss = 8.9483e-02, PNorm = 34.6920, GNorm = 1.3299, lr_0 = 2.2863e-04
Validation rmse = 1.717871
Epoch 19
Loss = 8.2830e-02, PNorm = 34.6991, GNorm = 0.5033, lr_0 = 2.1742e-04
Loss = 7.3895e-02, PNorm = 34.7038, GNorm = 0.3148, lr_0 = 2.0771e-04
Loss = 6.4742e-02, PNorm = 34.7042, GNorm = 0.3787, lr_0 = 2.0676e-04
Validation rmse = 1.556755
Epoch 20
Loss = 7.1475e-02, PNorm = 34.7112, GNorm = 0.3413, lr_0 = 1.9753e-04
Validation rmse = 1.370513
Epoch 21
Loss = 6.0695e-02, PNorm = 34.7171, GNorm = 0.2360, lr_0 = 1.8785e-04
Loss = 6.7627e-02, PNorm = 34.7235, GNorm = 0.2438, lr_0 = 1.7946e-04
Validation rmse = 1.363066
Epoch 22
Loss = 6.9953e-02, PNorm = 34.7302, GNorm = 0.4184, lr_0 = 1.7066e-04
Loss = 6.3349e-02, PNorm = 34.7351, GNorm = 1.0644, lr_0 = 1.6304e-04
Validation rmse = 1.318154
Epoch 23
Loss = 6.4619e-02, PNorm = 34.7413, GNorm = 0.2491, lr_0 = 1.5505e-04
Loss = 6.3794e-02, PNorm = 34.7459, GNorm = 0.7028, lr_0 = 1.4813e-04
Validation rmse = 1.308178
Epoch 24
Loss = 6.2509e-02, PNorm = 34.7519, GNorm = 0.7610, lr_0 = 1.4087e-04
Loss = 6.4250e-02, PNorm = 34.7570, GNorm = 0.4385, lr_0 = 1.3458e-04
Validation rmse = 1.301874
Epoch 25
Loss = 6.7614e-02, PNorm = 34.7613, GNorm = 0.3463, lr_0 = 1.2857e-04
Validation rmse = 1.279186
Epoch 26
Loss = 7.0589e-02, PNorm = 34.7659, GNorm = 1.1023, lr_0 = 1.2226e-04
Loss = 5.9533e-02, PNorm = 34.7708, GNorm = 0.3875, lr_0 = 1.1680e-04
Validation rmse = 1.273631
Epoch 27
Loss = 5.2986e-02, PNorm = 34.7740, GNorm = 0.2553, lr_0 = 1.1108e-04
Loss = 5.8897e-02, PNorm = 34.7768, GNorm = 0.3707, lr_0 = 1.0612e-04
Validation rmse = 1.219588
Epoch 28
Loss = 6.1285e-02, PNorm = 34.7810, GNorm = 0.3890, lr_0 = 1.0092e-04
Loss = 6.2371e-02, PNorm = 34.7848, GNorm = 0.8759, lr_0 = 1.0000e-04
Validation rmse = 1.309620
Epoch 29
Loss = 6.3732e-02, PNorm = 34.7870, GNorm = 0.4068, lr_0 = 1.0000e-04
Loss = 6.7032e-02, PNorm = 34.7900, GNorm = 0.3719, lr_0 = 1.0000e-04
Validation rmse = 1.395868
Model 0 best validation rmse = 1.219588 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 3.633698
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.889111
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 2.628384
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 2.374908
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 2.477306
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 2.093155
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.154187
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.757260
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 2.000148
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 1.913373
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.569437
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.559674
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.481722
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 1.968795
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3250e-02, PNorm = 34.6128, GNorm = 0.5350, lr_0 = 3.2059e-04
Loss = 1.3184e-01, PNorm = 34.6136, GNorm = 5.6786, lr_0 = 3.1913e-04
Validation rmse = 1.512706
Epoch 15
Loss = 8.9066e-02, PNorm = 34.6239, GNorm = 1.6323, lr_0 = 3.0488e-04
Validation rmse = 1.884779
Epoch 16
Loss = 9.0441e-02, PNorm = 34.6353, GNorm = 1.3797, lr_0 = 2.8994e-04
Loss = 9.6448e-02, PNorm = 34.6485, GNorm = 2.5399, lr_0 = 2.7699e-04
Validation rmse = 1.940334
Epoch 17
Loss = 8.4414e-02, PNorm = 34.6618, GNorm = 0.4887, lr_0 = 2.6341e-04
Loss = 8.3445e-02, PNorm = 34.6692, GNorm = 0.9714, lr_0 = 2.5165e-04
Validation rmse = 1.585641
Epoch 18
Loss = 9.1656e-02, PNorm = 34.6825, GNorm = 1.3956, lr_0 = 2.3931e-04
Loss = 8.9483e-02, PNorm = 34.6920, GNorm = 1.3299, lr_0 = 2.2863e-04
Validation rmse = 1.717871
Epoch 19
Loss = 8.2830e-02, PNorm = 34.6991, GNorm = 0.5033, lr_0 = 2.1742e-04
Loss = 7.3895e-02, PNorm = 34.7038, GNorm = 0.3148, lr_0 = 2.0771e-04
Loss = 6.4742e-02, PNorm = 34.7042, GNorm = 0.3787, lr_0 = 2.0676e-04
Validation rmse = 1.556755
Epoch 20
Loss = 7.1475e-02, PNorm = 34.7112, GNorm = 0.3413, lr_0 = 1.9753e-04
Validation rmse = 1.370513
Epoch 21
Loss = 6.0695e-02, PNorm = 34.7171, GNorm = 0.2360, lr_0 = 1.8785e-04
Loss = 6.7627e-02, PNorm = 34.7235, GNorm = 0.2438, lr_0 = 1.7946e-04
Validation rmse = 1.363066
Epoch 22
Loss = 6.9953e-02, PNorm = 34.7302, GNorm = 0.4184, lr_0 = 1.7066e-04
Loss = 6.3349e-02, PNorm = 34.7351, GNorm = 1.0644, lr_0 = 1.6304e-04
Validation rmse = 1.318154
Epoch 23
Loss = 6.4619e-02, PNorm = 34.7413, GNorm = 0.2491, lr_0 = 1.5505e-04
Loss = 6.3794e-02, PNorm = 34.7459, GNorm = 0.7028, lr_0 = 1.4813e-04
Validation rmse = 1.308178
Epoch 24
Loss = 6.2509e-02, PNorm = 34.7519, GNorm = 0.7610, lr_0 = 1.4087e-04
Loss = 6.4250e-02, PNorm = 34.7570, GNorm = 0.4385, lr_0 = 1.3458e-04
Validation rmse = 1.301874
Epoch 25
Loss = 6.7614e-02, PNorm = 34.7613, GNorm = 0.3463, lr_0 = 1.2857e-04
Validation rmse = 1.279186
Epoch 26
Loss = 7.0589e-02, PNorm = 34.7659, GNorm = 1.1023, lr_0 = 1.2226e-04
Loss = 5.9533e-02, PNorm = 34.7708, GNorm = 0.3875, lr_0 = 1.1680e-04
Validation rmse = 1.273631
Epoch 27
Loss = 5.2986e-02, PNorm = 34.7740, GNorm = 0.2553, lr_0 = 1.1108e-04
Loss = 5.8897e-02, PNorm = 34.7768, GNorm = 0.3707, lr_0 = 1.0612e-04
Validation rmse = 1.219588
Epoch 28
Loss = 6.1285e-02, PNorm = 34.7810, GNorm = 0.3890, lr_0 = 1.0092e-04
Loss = 6.2371e-02, PNorm = 34.7848, GNorm = 0.8759, lr_0 = 1.0000e-04
Validation rmse = 1.309620
Epoch 29
Loss = 6.3732e-02, PNorm = 34.7870, GNorm = 0.4068, lr_0 = 1.0000e-04
Loss = 6.7032e-02, PNorm = 34.7900, GNorm = 0.3719, lr_0 = 1.0000e-04
Validation rmse = 1.395868
Model 0 best validation rmse = 1.219588 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 3.633698
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.889111
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 2.628384
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 2.374908
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 2.477306
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 2.093155
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.154187
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.757260
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 2.000148
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 1.913373
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.569437
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.559674
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.481722
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 1.968795
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3250e-02, PNorm = 34.6128, GNorm = 0.5350, lr_0 = 3.2059e-04
Loss = 1.3184e-01, PNorm = 34.6136, GNorm = 5.6786, lr_0 = 3.1913e-04
Validation rmse = 1.512706
Epoch 15
Loss = 8.9066e-02, PNorm = 34.6239, GNorm = 1.6323, lr_0 = 3.0488e-04
Validation rmse = 1.884779
Epoch 16
Loss = 9.0441e-02, PNorm = 34.6353, GNorm = 1.3797, lr_0 = 2.8994e-04
Loss = 9.6448e-02, PNorm = 34.6485, GNorm = 2.5399, lr_0 = 2.7699e-04
Validation rmse = 1.940334
Epoch 17
Loss = 8.4414e-02, PNorm = 34.6618, GNorm = 0.4887, lr_0 = 2.6341e-04
Loss = 8.3445e-02, PNorm = 34.6692, GNorm = 0.9714, lr_0 = 2.5165e-04
Validation rmse = 1.585641
Epoch 18
Loss = 9.1656e-02, PNorm = 34.6825, GNorm = 1.3956, lr_0 = 2.3931e-04
Loss = 8.9483e-02, PNorm = 34.6920, GNorm = 1.3299, lr_0 = 2.2863e-04
Validation rmse = 1.717871
Epoch 19
Loss = 8.2830e-02, PNorm = 34.6991, GNorm = 0.5033, lr_0 = 2.1742e-04
Loss = 7.3895e-02, PNorm = 34.7038, GNorm = 0.3148, lr_0 = 2.0771e-04
Loss = 6.4742e-02, PNorm = 34.7042, GNorm = 0.3787, lr_0 = 2.0676e-04
Validation rmse = 1.556755
Epoch 20
Loss = 7.1475e-02, PNorm = 34.7112, GNorm = 0.3413, lr_0 = 1.9753e-04
Validation rmse = 1.370513
Epoch 21
Loss = 6.0695e-02, PNorm = 34.7171, GNorm = 0.2360, lr_0 = 1.8785e-04
Loss = 6.7627e-02, PNorm = 34.7235, GNorm = 0.2438, lr_0 = 1.7946e-04
Validation rmse = 1.363066
Epoch 22
Loss = 6.9953e-02, PNorm = 34.7302, GNorm = 0.4184, lr_0 = 1.7066e-04
Loss = 6.3349e-02, PNorm = 34.7351, GNorm = 1.0644, lr_0 = 1.6304e-04
Validation rmse = 1.318154
Epoch 23
Loss = 6.4619e-02, PNorm = 34.7413, GNorm = 0.2491, lr_0 = 1.5505e-04
Loss = 6.3794e-02, PNorm = 34.7459, GNorm = 0.7028, lr_0 = 1.4813e-04
Validation rmse = 1.308178
Epoch 24
Loss = 6.2509e-02, PNorm = 34.7519, GNorm = 0.7610, lr_0 = 1.4087e-04
Loss = 6.4250e-02, PNorm = 34.7570, GNorm = 0.4385, lr_0 = 1.3458e-04
Validation rmse = 1.301874
Epoch 25
Loss = 6.7614e-02, PNorm = 34.7613, GNorm = 0.3463, lr_0 = 1.2857e-04
Validation rmse = 1.279186
Epoch 26
Loss = 7.0589e-02, PNorm = 34.7659, GNorm = 1.1023, lr_0 = 1.2226e-04
Loss = 5.9533e-02, PNorm = 34.7708, GNorm = 0.3875, lr_0 = 1.1680e-04
Validation rmse = 1.273631
Epoch 27
Loss = 5.2986e-02, PNorm = 34.7740, GNorm = 0.2553, lr_0 = 1.1108e-04
Loss = 5.8897e-02, PNorm = 34.7768, GNorm = 0.3707, lr_0 = 1.0612e-04
Validation rmse = 1.219588
Epoch 28
Loss = 6.1285e-02, PNorm = 34.7810, GNorm = 0.3890, lr_0 = 1.0092e-04
Loss = 6.2371e-02, PNorm = 34.7848, GNorm = 0.8759, lr_0 = 1.0000e-04
Validation rmse = 1.309620
Epoch 29
Loss = 6.3732e-02, PNorm = 34.7870, GNorm = 0.4068, lr_0 = 1.0000e-04
Loss = 6.7032e-02, PNorm = 34.7900, GNorm = 0.3719, lr_0 = 1.0000e-04
Validation rmse = 1.395868
Model 0 best validation rmse = 1.219588 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 3.013953
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.776288
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 3.472743
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 1.938467
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 2.726704
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 1.711399
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.176765
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.636489
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 1.518256
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 2.410900
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.339356
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.553287
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.556528
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 2.520034
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3250e-02, PNorm = 34.6128, GNorm = 0.5350, lr_0 = 3.2059e-04
Loss = 1.3184e-01, PNorm = 34.6136, GNorm = 5.6786, lr_0 = 3.1913e-04
Validation rmse = 1.662578
Epoch 15
Loss = 8.9066e-02, PNorm = 34.6239, GNorm = 1.6323, lr_0 = 3.0488e-04
Validation rmse = 2.240315
Epoch 16
Loss = 9.0441e-02, PNorm = 34.6353, GNorm = 1.3797, lr_0 = 2.8994e-04
Loss = 9.6448e-02, PNorm = 34.6485, GNorm = 2.5399, lr_0 = 2.7699e-04
Validation rmse = 2.592600
Epoch 17
Loss = 8.4414e-02, PNorm = 34.6618, GNorm = 0.4887, lr_0 = 2.6341e-04
Loss = 8.3445e-02, PNorm = 34.6692, GNorm = 0.9714, lr_0 = 2.5165e-04
Validation rmse = 1.685696
Epoch 18
Loss = 9.1656e-02, PNorm = 34.6825, GNorm = 1.3956, lr_0 = 2.3931e-04
Loss = 8.9483e-02, PNorm = 34.6920, GNorm = 1.3299, lr_0 = 2.2863e-04
Validation rmse = 2.019130
Epoch 19
Loss = 8.2830e-02, PNorm = 34.6991, GNorm = 0.5033, lr_0 = 2.1742e-04
Loss = 7.3895e-02, PNorm = 34.7038, GNorm = 0.3148, lr_0 = 2.0771e-04
Loss = 6.4742e-02, PNorm = 34.7042, GNorm = 0.3787, lr_0 = 2.0676e-04
Validation rmse = 1.764812
Epoch 20
Loss = 7.1475e-02, PNorm = 34.7112, GNorm = 0.3413, lr_0 = 1.9753e-04
Validation rmse = 1.410005
Epoch 21
Loss = 6.0695e-02, PNorm = 34.7171, GNorm = 0.2360, lr_0 = 1.8785e-04
Loss = 6.7627e-02, PNorm = 34.7235, GNorm = 0.2438, lr_0 = 1.7946e-04
Validation rmse = 1.368812
Epoch 22
Loss = 6.9953e-02, PNorm = 34.7302, GNorm = 0.4184, lr_0 = 1.7066e-04
Loss = 6.3349e-02, PNorm = 34.7351, GNorm = 1.0644, lr_0 = 1.6304e-04
Validation rmse = 1.434150
Epoch 23
Loss = 6.4619e-02, PNorm = 34.7413, GNorm = 0.2491, lr_0 = 1.5505e-04
Loss = 6.3794e-02, PNorm = 34.7459, GNorm = 0.7028, lr_0 = 1.4813e-04
Validation rmse = 1.398943
Epoch 24
Loss = 6.2509e-02, PNorm = 34.7519, GNorm = 0.7610, lr_0 = 1.4087e-04
Loss = 6.4250e-02, PNorm = 34.7570, GNorm = 0.4385, lr_0 = 1.3458e-04
Validation rmse = 1.089957
Epoch 25
Loss = 6.7614e-02, PNorm = 34.7613, GNorm = 0.3463, lr_0 = 1.2857e-04
Validation rmse = 1.433695
Epoch 26
Loss = 7.0589e-02, PNorm = 34.7659, GNorm = 1.1023, lr_0 = 1.2226e-04
Loss = 5.9533e-02, PNorm = 34.7708, GNorm = 0.3875, lr_0 = 1.1680e-04
Validation rmse = 1.299791
Epoch 27
Loss = 5.2986e-02, PNorm = 34.7740, GNorm = 0.2553, lr_0 = 1.1108e-04
Loss = 5.8897e-02, PNorm = 34.7768, GNorm = 0.3707, lr_0 = 1.0612e-04
Validation rmse = 1.054059
Epoch 28
Loss = 6.1285e-02, PNorm = 34.7810, GNorm = 0.3890, lr_0 = 1.0092e-04
Loss = 6.2371e-02, PNorm = 34.7848, GNorm = 0.8759, lr_0 = 1.0000e-04
Validation rmse = 1.155447
Epoch 29
Loss = 6.3732e-02, PNorm = 34.7870, GNorm = 0.4068, lr_0 = 1.0000e-04
Loss = 6.7032e-02, PNorm = 34.7900, GNorm = 0.3719, lr_0 = 1.0000e-04
Validation rmse = 1.361330
Model 0 best validation rmse = 1.054059 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 3.013953
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.776288
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 3.472743
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 1.938467
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 2.726704
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 1.711399
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.176765
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.636489
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 1.518256
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 2.410900
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.339356
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.553287
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.556528
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 2.520034
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3250e-02, PNorm = 34.6128, GNorm = 0.5350, lr_0 = 3.2059e-04
Loss = 1.3184e-01, PNorm = 34.6136, GNorm = 5.6786, lr_0 = 3.1913e-04
Validation rmse = 1.662578
Epoch 15
Loss = 8.9066e-02, PNorm = 34.6239, GNorm = 1.6323, lr_0 = 3.0488e-04
Validation rmse = 2.240315
Epoch 16
Loss = 9.0441e-02, PNorm = 34.6353, GNorm = 1.3797, lr_0 = 2.8994e-04
Loss = 9.6448e-02, PNorm = 34.6485, GNorm = 2.5399, lr_0 = 2.7699e-04
Validation rmse = 2.592600
Epoch 17
Loss = 8.4414e-02, PNorm = 34.6618, GNorm = 0.4887, lr_0 = 2.6341e-04
Loss = 8.3445e-02, PNorm = 34.6692, GNorm = 0.9714, lr_0 = 2.5165e-04
Validation rmse = 1.685696
Epoch 18
Loss = 9.1656e-02, PNorm = 34.6825, GNorm = 1.3956, lr_0 = 2.3931e-04
Loss = 8.9483e-02, PNorm = 34.6920, GNorm = 1.3299, lr_0 = 2.2863e-04
Validation rmse = 2.019130
Epoch 19
Loss = 8.2830e-02, PNorm = 34.6991, GNorm = 0.5033, lr_0 = 2.1742e-04
Loss = 7.3895e-02, PNorm = 34.7038, GNorm = 0.3148, lr_0 = 2.0771e-04
Loss = 6.4742e-02, PNorm = 34.7042, GNorm = 0.3787, lr_0 = 2.0676e-04
Validation rmse = 1.764812
Epoch 20
Loss = 7.1475e-02, PNorm = 34.7112, GNorm = 0.3413, lr_0 = 1.9753e-04
Validation rmse = 1.410005
Epoch 21
Loss = 6.0695e-02, PNorm = 34.7171, GNorm = 0.2360, lr_0 = 1.8785e-04
Loss = 6.7627e-02, PNorm = 34.7235, GNorm = 0.2438, lr_0 = 1.7946e-04
Validation rmse = 1.368812
Epoch 22
Loss = 6.9953e-02, PNorm = 34.7302, GNorm = 0.4184, lr_0 = 1.7066e-04
Loss = 6.3349e-02, PNorm = 34.7351, GNorm = 1.0644, lr_0 = 1.6304e-04
Validation rmse = 1.434150
Epoch 23
Loss = 6.4619e-02, PNorm = 34.7413, GNorm = 0.2491, lr_0 = 1.5505e-04
Loss = 6.3794e-02, PNorm = 34.7459, GNorm = 0.7028, lr_0 = 1.4813e-04
Validation rmse = 1.398943
Epoch 24
Loss = 6.2509e-02, PNorm = 34.7519, GNorm = 0.7610, lr_0 = 1.4087e-04
Loss = 6.4250e-02, PNorm = 34.7570, GNorm = 0.4385, lr_0 = 1.3458e-04
Validation rmse = 1.089957
Epoch 25
Loss = 6.7614e-02, PNorm = 34.7613, GNorm = 0.3463, lr_0 = 1.2857e-04
Validation rmse = 1.433695
Epoch 26
Loss = 7.0589e-02, PNorm = 34.7659, GNorm = 1.1023, lr_0 = 1.2226e-04
Loss = 5.9533e-02, PNorm = 34.7708, GNorm = 0.3875, lr_0 = 1.1680e-04
Validation rmse = 1.299791
Epoch 27
Loss = 5.2986e-02, PNorm = 34.7740, GNorm = 0.2553, lr_0 = 1.1108e-04
Loss = 5.8897e-02, PNorm = 34.7768, GNorm = 0.3707, lr_0 = 1.0612e-04
Validation rmse = 1.054059
Epoch 28
Loss = 6.1285e-02, PNorm = 34.7810, GNorm = 0.3890, lr_0 = 1.0092e-04
Loss = 6.2371e-02, PNorm = 34.7848, GNorm = 0.8759, lr_0 = 1.0000e-04
Validation rmse = 1.155447
Epoch 29
Loss = 6.3732e-02, PNorm = 34.7870, GNorm = 0.4068, lr_0 = 1.0000e-04
Loss = 6.7032e-02, PNorm = 34.7900, GNorm = 0.3719, lr_0 = 1.0000e-04
Validation rmse = 1.361330
Model 0 best validation rmse = 1.054059 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 3.013953
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.776288
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 3.472743
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 1.938467
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 2.726704
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 1.711399
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.176765
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.636489
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 1.518256
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 2.410900
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.339356
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.553287
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.556528
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 2.520034
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3250e-02, PNorm = 34.6128, GNorm = 0.5350, lr_0 = 3.2059e-04
Loss = 1.3184e-01, PNorm = 34.6136, GNorm = 5.6786, lr_0 = 3.1913e-04
Validation rmse = 1.662578
Epoch 15
Loss = 8.9066e-02, PNorm = 34.6239, GNorm = 1.6323, lr_0 = 3.0488e-04
Validation rmse = 2.240315
Epoch 16
Loss = 9.0441e-02, PNorm = 34.6353, GNorm = 1.3797, lr_0 = 2.8994e-04
Loss = 9.6448e-02, PNorm = 34.6485, GNorm = 2.5399, lr_0 = 2.7699e-04
Validation rmse = 2.592600
Epoch 17
Loss = 8.4414e-02, PNorm = 34.6618, GNorm = 0.4887, lr_0 = 2.6341e-04
Loss = 8.3445e-02, PNorm = 34.6692, GNorm = 0.9714, lr_0 = 2.5165e-04
Validation rmse = 1.685696
Epoch 18
Loss = 9.1656e-02, PNorm = 34.6825, GNorm = 1.3956, lr_0 = 2.3931e-04
Loss = 8.9483e-02, PNorm = 34.6920, GNorm = 1.3299, lr_0 = 2.2863e-04
Validation rmse = 2.019130
Epoch 19
Loss = 8.2830e-02, PNorm = 34.6991, GNorm = 0.5033, lr_0 = 2.1742e-04
Loss = 7.3895e-02, PNorm = 34.7038, GNorm = 0.3148, lr_0 = 2.0771e-04
Loss = 6.4742e-02, PNorm = 34.7042, GNorm = 0.3787, lr_0 = 2.0676e-04
Validation rmse = 1.764812
Epoch 20
Loss = 7.1475e-02, PNorm = 34.7112, GNorm = 0.3413, lr_0 = 1.9753e-04
Validation rmse = 1.410005
Epoch 21
Loss = 6.0695e-02, PNorm = 34.7171, GNorm = 0.2360, lr_0 = 1.8785e-04
Loss = 6.7627e-02, PNorm = 34.7235, GNorm = 0.2438, lr_0 = 1.7946e-04
Validation rmse = 1.368812
Epoch 22
Loss = 6.9953e-02, PNorm = 34.7302, GNorm = 0.4184, lr_0 = 1.7066e-04
Loss = 6.3349e-02, PNorm = 34.7351, GNorm = 1.0644, lr_0 = 1.6304e-04
Validation rmse = 1.434150
Epoch 23
Loss = 6.4619e-02, PNorm = 34.7413, GNorm = 0.2491, lr_0 = 1.5505e-04
Loss = 6.3794e-02, PNorm = 34.7459, GNorm = 0.7028, lr_0 = 1.4813e-04
Validation rmse = 1.398943
Epoch 24
Loss = 6.2509e-02, PNorm = 34.7519, GNorm = 0.7610, lr_0 = 1.4087e-04
Loss = 6.4250e-02, PNorm = 34.7570, GNorm = 0.4385, lr_0 = 1.3458e-04
Validation rmse = 1.089957
Epoch 25
Loss = 6.7614e-02, PNorm = 34.7613, GNorm = 0.3463, lr_0 = 1.2857e-04
Validation rmse = 1.433695
Epoch 26
Loss = 7.0589e-02, PNorm = 34.7659, GNorm = 1.1023, lr_0 = 1.2226e-04
Loss = 5.9533e-02, PNorm = 34.7708, GNorm = 0.3875, lr_0 = 1.1680e-04
Validation rmse = 1.299791
Epoch 27
Loss = 5.2986e-02, PNorm = 34.7740, GNorm = 0.2553, lr_0 = 1.1108e-04
Loss = 5.8897e-02, PNorm = 34.7768, GNorm = 0.3707, lr_0 = 1.0612e-04
Validation rmse = 1.054059
Epoch 28
Loss = 6.1285e-02, PNorm = 34.7810, GNorm = 0.3890, lr_0 = 1.0092e-04
Loss = 6.2371e-02, PNorm = 34.7848, GNorm = 0.8759, lr_0 = 1.0000e-04
Validation rmse = 1.155447
Epoch 29
Loss = 6.3732e-02, PNorm = 34.7870, GNorm = 0.4068, lr_0 = 1.0000e-04
Loss = 6.7032e-02, PNorm = 34.7900, GNorm = 0.3719, lr_0 = 1.0000e-04
Validation rmse = 1.361330
Model 0 best validation rmse = 1.054059 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 3.633698
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.889111
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 2.628384
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 2.374908
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 2.477306
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 2.093155
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.154187
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.757260
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 2.000148
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 1.913373
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.569437
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.559674
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.481722
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 1.968795
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3089e-02, PNorm = 34.6126, GNorm = 0.5348, lr_0 = 3.2059e-04
Loss = 1.2179e-01, PNorm = 34.6133, GNorm = 5.6841, lr_0 = 3.1913e-04
Validation rmse = 1.511309
Epoch 15
Loss = 9.0250e-02, PNorm = 34.6236, GNorm = 1.6117, lr_0 = 3.0488e-04
Validation rmse = 1.903152
Epoch 16
Loss = 8.8282e-02, PNorm = 34.6350, GNorm = 1.1454, lr_0 = 2.8994e-04
Loss = 9.5241e-02, PNorm = 34.6479, GNorm = 2.3054, lr_0 = 2.7699e-04
Validation rmse = 1.857862
Epoch 17
Loss = 8.0677e-02, PNorm = 34.6599, GNorm = 0.4680, lr_0 = 2.6341e-04
Loss = 8.2868e-02, PNorm = 34.6667, GNorm = 1.2074, lr_0 = 2.5165e-04
Validation rmse = 1.607786
Epoch 18
Loss = 9.2232e-02, PNorm = 34.6801, GNorm = 1.7450, lr_0 = 2.3931e-04
Loss = 9.2557e-02, PNorm = 34.6912, GNorm = 1.6762, lr_0 = 2.2863e-04
Validation rmse = 1.766352
Epoch 19
Loss = 8.4635e-02, PNorm = 34.6986, GNorm = 0.5126, lr_0 = 2.1742e-04
Loss = 7.0436e-02, PNorm = 34.7034, GNorm = 0.3359, lr_0 = 2.0771e-04
Loss = 5.9165e-02, PNorm = 34.7037, GNorm = 0.3711, lr_0 = 2.0676e-04
Validation rmse = 1.467565
Epoch 20
Loss = 7.2611e-02, PNorm = 34.7115, GNorm = 0.4190, lr_0 = 1.9753e-04
Validation rmse = 1.296009
Epoch 21
Loss = 6.6460e-02, PNorm = 34.7166, GNorm = 1.0391, lr_0 = 1.8785e-04
Loss = 7.0367e-02, PNorm = 34.7222, GNorm = 0.5574, lr_0 = 1.7946e-04
Validation rmse = 1.394813
Epoch 22
Loss = 6.9979e-02, PNorm = 34.7279, GNorm = 0.4058, lr_0 = 1.7066e-04
Loss = 6.3325e-02, PNorm = 34.7318, GNorm = 0.9101, lr_0 = 1.6304e-04
Validation rmse = 1.343486
Epoch 23
Loss = 6.4316e-02, PNorm = 34.7379, GNorm = 0.3493, lr_0 = 1.5505e-04
Loss = 6.3947e-02, PNorm = 34.7427, GNorm = 0.9589, lr_0 = 1.4813e-04
Validation rmse = 1.297694
Epoch 24
Loss = 6.4292e-02, PNorm = 34.7488, GNorm = 1.1051, lr_0 = 1.4087e-04
Loss = 6.9343e-02, PNorm = 34.7525, GNorm = 0.4367, lr_0 = 1.3458e-04
Validation rmse = 1.344147
Epoch 25
Loss = 6.6601e-02, PNorm = 34.7564, GNorm = 0.6217, lr_0 = 1.2857e-04
Validation rmse = 1.238236
Epoch 26
Loss = 6.7205e-02, PNorm = 34.7613, GNorm = 0.7932, lr_0 = 1.2226e-04
Loss = 5.8981e-02, PNorm = 34.7659, GNorm = 0.4832, lr_0 = 1.1680e-04
Validation rmse = 1.315207
Epoch 27
Loss = 5.5413e-02, PNorm = 34.7694, GNorm = 0.7822, lr_0 = 1.1108e-04
Loss = 6.0128e-02, PNorm = 34.7727, GNorm = 0.3215, lr_0 = 1.0612e-04
Validation rmse = 1.276585
Epoch 28
Loss = 8.1015e-02, PNorm = 34.7770, GNorm = 0.7629, lr_0 = 1.0092e-04
Loss = 7.4583e-02, PNorm = 34.7801, GNorm = 0.3979, lr_0 = 1.0000e-04
Validation rmse = 1.630910
Epoch 29
Loss = 6.5547e-02, PNorm = 34.7828, GNorm = 0.2526, lr_0 = 1.0000e-04
Loss = 6.6002e-02, PNorm = 34.7846, GNorm = 1.1083, lr_0 = 1.0000e-04
Validation rmse = 1.226848
Model 0 best validation rmse = 1.226848 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 3.633698
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.889111
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 2.628384
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 2.374908
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 2.477306
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 2.093155
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.154187
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.757260
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 2.000148
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 1.913373
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.569437
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.559674
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.481722
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 1.968795
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3250e-02, PNorm = 34.6128, GNorm = 0.5350, lr_0 = 3.2059e-04
Loss = 1.3184e-01, PNorm = 34.6136, GNorm = 5.6786, lr_0 = 3.1913e-04
Validation rmse = 1.512706
Epoch 15
Loss = 8.9066e-02, PNorm = 34.6239, GNorm = 1.6323, lr_0 = 3.0488e-04
Validation rmse = 1.884779
Epoch 16
Loss = 9.0441e-02, PNorm = 34.6353, GNorm = 1.3797, lr_0 = 2.8994e-04
Loss = 9.6448e-02, PNorm = 34.6485, GNorm = 2.5399, lr_0 = 2.7699e-04
Validation rmse = 1.940334
Epoch 17
Loss = 8.4414e-02, PNorm = 34.6618, GNorm = 0.4887, lr_0 = 2.6341e-04
Loss = 8.3445e-02, PNorm = 34.6692, GNorm = 0.9714, lr_0 = 2.5165e-04
Validation rmse = 1.585641
Epoch 18
Loss = 9.1656e-02, PNorm = 34.6825, GNorm = 1.3956, lr_0 = 2.3931e-04
Loss = 8.9483e-02, PNorm = 34.6920, GNorm = 1.3299, lr_0 = 2.2863e-04
Validation rmse = 1.717871
Epoch 19
Loss = 8.2830e-02, PNorm = 34.6991, GNorm = 0.5033, lr_0 = 2.1742e-04
Loss = 7.3895e-02, PNorm = 34.7038, GNorm = 0.3148, lr_0 = 2.0771e-04
Loss = 6.4742e-02, PNorm = 34.7042, GNorm = 0.3787, lr_0 = 2.0676e-04
Validation rmse = 1.556755
Epoch 20
Loss = 7.1475e-02, PNorm = 34.7112, GNorm = 0.3413, lr_0 = 1.9753e-04
Validation rmse = 1.370513
Epoch 21
Loss = 6.0695e-02, PNorm = 34.7171, GNorm = 0.2360, lr_0 = 1.8785e-04
Loss = 6.7627e-02, PNorm = 34.7235, GNorm = 0.2438, lr_0 = 1.7946e-04
Validation rmse = 1.363066
Epoch 22
Loss = 6.9953e-02, PNorm = 34.7302, GNorm = 0.4184, lr_0 = 1.7066e-04
Loss = 6.3349e-02, PNorm = 34.7351, GNorm = 1.0644, lr_0 = 1.6304e-04
Validation rmse = 1.318154
Epoch 23
Loss = 6.4619e-02, PNorm = 34.7413, GNorm = 0.2491, lr_0 = 1.5505e-04
Loss = 6.3794e-02, PNorm = 34.7459, GNorm = 0.7028, lr_0 = 1.4813e-04
Validation rmse = 1.308178
Epoch 24
Loss = 6.2509e-02, PNorm = 34.7519, GNorm = 0.7610, lr_0 = 1.4087e-04
Loss = 6.4250e-02, PNorm = 34.7570, GNorm = 0.4385, lr_0 = 1.3458e-04
Validation rmse = 1.301874
Epoch 25
Loss = 6.7614e-02, PNorm = 34.7613, GNorm = 0.3463, lr_0 = 1.2857e-04
Validation rmse = 1.279186
Epoch 26
Loss = 7.0589e-02, PNorm = 34.7659, GNorm = 1.1023, lr_0 = 1.2226e-04
Loss = 5.9533e-02, PNorm = 34.7708, GNorm = 0.3875, lr_0 = 1.1680e-04
Validation rmse = 1.273631
Epoch 27
Loss = 5.2986e-02, PNorm = 34.7740, GNorm = 0.2553, lr_0 = 1.1108e-04
Loss = 5.8897e-02, PNorm = 34.7768, GNorm = 0.3707, lr_0 = 1.0612e-04
Validation rmse = 1.219588
Epoch 28
Loss = 6.1285e-02, PNorm = 34.7810, GNorm = 0.3890, lr_0 = 1.0092e-04
Loss = 6.2371e-02, PNorm = 34.7848, GNorm = 0.8759, lr_0 = 1.0000e-04
Validation rmse = 1.309620
Epoch 29
Loss = 6.3732e-02, PNorm = 34.7870, GNorm = 0.4068, lr_0 = 1.0000e-04
Loss = 6.7032e-02, PNorm = 34.7900, GNorm = 0.3719, lr_0 = 1.0000e-04
Validation rmse = 1.395868
Model 0 best validation rmse = 1.219588 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 3.633698
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.889111
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 2.628384
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 2.374908
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 2.477306
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 2.093155
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.154187
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.757260
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 2.000148
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 1.913373
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.569437
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.559674
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.481722
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 1.968795
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3250e-02, PNorm = 34.6128, GNorm = 0.5350, lr_0 = 3.2059e-04
Loss = 1.3184e-01, PNorm = 34.6136, GNorm = 5.6786, lr_0 = 3.1913e-04
Validation rmse = 1.512706
Epoch 15
Loss = 8.9066e-02, PNorm = 34.6239, GNorm = 1.6323, lr_0 = 3.0488e-04
Validation rmse = 1.884779
Epoch 16
Loss = 9.0441e-02, PNorm = 34.6353, GNorm = 1.3797, lr_0 = 2.8994e-04
Loss = 9.6448e-02, PNorm = 34.6485, GNorm = 2.5399, lr_0 = 2.7699e-04
Validation rmse = 1.940334
Epoch 17
Loss = 8.4414e-02, PNorm = 34.6618, GNorm = 0.4887, lr_0 = 2.6341e-04
Loss = 8.3445e-02, PNorm = 34.6692, GNorm = 0.9714, lr_0 = 2.5165e-04
Validation rmse = 1.585641
Epoch 18
Loss = 9.1656e-02, PNorm = 34.6825, GNorm = 1.3956, lr_0 = 2.3931e-04
Loss = 8.9483e-02, PNorm = 34.6920, GNorm = 1.3299, lr_0 = 2.2863e-04
Validation rmse = 1.717871
Epoch 19
Loss = 8.2830e-02, PNorm = 34.6991, GNorm = 0.5033, lr_0 = 2.1742e-04
Loss = 7.3895e-02, PNorm = 34.7038, GNorm = 0.3148, lr_0 = 2.0771e-04
Loss = 6.4742e-02, PNorm = 34.7042, GNorm = 0.3787, lr_0 = 2.0676e-04
Validation rmse = 1.556755
Epoch 20
Loss = 7.1475e-02, PNorm = 34.7112, GNorm = 0.3413, lr_0 = 1.9753e-04
Validation rmse = 1.370513
Epoch 21
Loss = 6.0695e-02, PNorm = 34.7171, GNorm = 0.2360, lr_0 = 1.8785e-04
Loss = 6.7627e-02, PNorm = 34.7235, GNorm = 0.2438, lr_0 = 1.7946e-04
Validation rmse = 1.363066
Epoch 22
Loss = 6.9953e-02, PNorm = 34.7302, GNorm = 0.4184, lr_0 = 1.7066e-04
Loss = 6.3349e-02, PNorm = 34.7351, GNorm = 1.0644, lr_0 = 1.6304e-04
Validation rmse = 1.318154
Epoch 23
Loss = 6.4619e-02, PNorm = 34.7413, GNorm = 0.2491, lr_0 = 1.5505e-04
Loss = 6.3794e-02, PNorm = 34.7459, GNorm = 0.7028, lr_0 = 1.4813e-04
Validation rmse = 1.308178
Epoch 24
Loss = 6.2509e-02, PNorm = 34.7519, GNorm = 0.7610, lr_0 = 1.4087e-04
Loss = 6.4250e-02, PNorm = 34.7570, GNorm = 0.4385, lr_0 = 1.3458e-04
Validation rmse = 1.301874
Epoch 25
Loss = 6.7614e-02, PNorm = 34.7613, GNorm = 0.3463, lr_0 = 1.2857e-04
Validation rmse = 1.279186
Epoch 26
Loss = 7.0589e-02, PNorm = 34.7659, GNorm = 1.1023, lr_0 = 1.2226e-04
Loss = 5.9533e-02, PNorm = 34.7708, GNorm = 0.3875, lr_0 = 1.1680e-04
Validation rmse = 1.273631
Epoch 27
Loss = 5.2986e-02, PNorm = 34.7740, GNorm = 0.2553, lr_0 = 1.1108e-04
Loss = 5.8897e-02, PNorm = 34.7768, GNorm = 0.3707, lr_0 = 1.0612e-04
Validation rmse = 1.219588
Epoch 28
Loss = 6.1285e-02, PNorm = 34.7810, GNorm = 0.3890, lr_0 = 1.0092e-04
Loss = 6.2371e-02, PNorm = 34.7848, GNorm = 0.8759, lr_0 = 1.0000e-04
Validation rmse = 1.309620
Epoch 29
Loss = 6.3732e-02, PNorm = 34.7870, GNorm = 0.4068, lr_0 = 1.0000e-04
Loss = 6.7032e-02, PNorm = 34.7900, GNorm = 0.3719, lr_0 = 1.0000e-04
Validation rmse = 1.395868
Model 0 best validation rmse = 1.219588 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 3.1728e-01, PNorm = 34.0649, GNorm = 0.9414, lr_0 = 3.7500e-04
Validation rmse = 3.633698
Epoch 1
Loss = 1.8766e-01, PNorm = 34.0727, GNorm = 0.5186, lr_0 = 6.5000e-04
Loss = 1.7741e-01, PNorm = 34.0957, GNorm = 0.3657, lr_0 = 9.0000e-04
Validation rmse = 2.889111
Epoch 2
Loss = 1.4157e-01, PNorm = 34.1390, GNorm = 1.0994, lr_0 = 9.6853e-04
Loss = 1.4072e-01, PNorm = 34.1831, GNorm = 0.4169, lr_0 = 9.2527e-04
Validation rmse = 2.628384
Epoch 3
Loss = 1.4394e-01, PNorm = 34.2146, GNorm = 0.4896, lr_0 = 8.7992e-04
Loss = 1.4156e-01, PNorm = 34.2353, GNorm = 0.7115, lr_0 = 8.4063e-04
Validation rmse = 2.374908
Epoch 4
Loss = 1.2346e-01, PNorm = 34.2642, GNorm = 0.4369, lr_0 = 7.9943e-04
Loss = 1.4171e-01, PNorm = 34.2871, GNorm = 0.5131, lr_0 = 7.6372e-04
Loss = 9.9899e-02, PNorm = 34.2892, GNorm = 0.4335, lr_0 = 7.6024e-04
Validation rmse = 2.477306
Epoch 5
Loss = 1.1656e-01, PNorm = 34.3158, GNorm = 1.2111, lr_0 = 7.2629e-04
Validation rmse = 2.093155
Epoch 6
Loss = 1.2013e-01, PNorm = 34.3413, GNorm = 1.7789, lr_0 = 6.9069e-04
Loss = 1.1164e-01, PNorm = 34.3637, GNorm = 1.2710, lr_0 = 6.5985e-04
Validation rmse = 2.154187
Epoch 7
Loss = 1.1382e-01, PNorm = 34.3837, GNorm = 1.4983, lr_0 = 6.2751e-04
Loss = 9.8614e-02, PNorm = 34.4085, GNorm = 0.6640, lr_0 = 5.9948e-04
Validation rmse = 1.757260
Epoch 8
Loss = 1.0129e-01, PNorm = 34.4268, GNorm = 1.8242, lr_0 = 5.7010e-04
Loss = 1.0796e-01, PNorm = 34.4458, GNorm = 0.8499, lr_0 = 5.4464e-04
Validation rmse = 2.000148
Epoch 9
Loss = 1.0451e-01, PNorm = 34.4626, GNorm = 1.0642, lr_0 = 5.1795e-04
Loss = 8.8528e-02, PNorm = 34.4809, GNorm = 0.4551, lr_0 = 4.9482e-04
Loss = 9.5391e-02, PNorm = 34.4823, GNorm = 0.5066, lr_0 = 4.9256e-04
Validation rmse = 1.913373
Epoch 10
Loss = 8.9823e-02, PNorm = 34.4995, GNorm = 0.7097, lr_0 = 4.7056e-04
Validation rmse = 1.569437
Epoch 11
Loss = 9.4204e-02, PNorm = 34.5172, GNorm = 1.7831, lr_0 = 4.4750e-04
Loss = 8.7172e-02, PNorm = 34.5355, GNorm = 0.3211, lr_0 = 4.2752e-04
Validation rmse = 1.559674
Epoch 12
Loss = 7.8605e-02, PNorm = 34.5503, GNorm = 0.5828, lr_0 = 4.0656e-04
Loss = 8.2471e-02, PNorm = 34.5629, GNorm = 0.7496, lr_0 = 3.8841e-04
Validation rmse = 1.481722
Epoch 13
Loss = 7.7819e-02, PNorm = 34.5729, GNorm = 1.2368, lr_0 = 3.6937e-04
Loss = 8.3892e-02, PNorm = 34.5865, GNorm = 0.4831, lr_0 = 3.5287e-04
Validation rmse = 1.968795
Epoch 14
Loss = 8.7831e-02, PNorm = 34.5992, GNorm = 1.5497, lr_0 = 3.3558e-04
Loss = 7.3089e-02, PNorm = 34.6126, GNorm = 0.5348, lr_0 = 3.2059e-04
Loss = 1.2179e-01, PNorm = 34.6133, GNorm = 5.6841, lr_0 = 3.1913e-04
Validation rmse = 1.511309
Epoch 15
Loss = 9.0250e-02, PNorm = 34.6236, GNorm = 1.6117, lr_0 = 3.0488e-04
Validation rmse = 1.903152
Epoch 16
Loss = 8.8282e-02, PNorm = 34.6350, GNorm = 1.1454, lr_0 = 2.8994e-04
Loss = 9.5241e-02, PNorm = 34.6479, GNorm = 2.3054, lr_0 = 2.7699e-04
Validation rmse = 1.857862
Epoch 17
Loss = 8.0677e-02, PNorm = 34.6599, GNorm = 0.4680, lr_0 = 2.6341e-04
Loss = 8.2868e-02, PNorm = 34.6667, GNorm = 1.2074, lr_0 = 2.5165e-04
Validation rmse = 1.607786
Epoch 18
Loss = 9.2232e-02, PNorm = 34.6801, GNorm = 1.7449, lr_0 = 2.3931e-04
Loss = 9.2557e-02, PNorm = 34.6912, GNorm = 1.6762, lr_0 = 2.2863e-04
Validation rmse = 1.766345
Epoch 19
Loss = 8.4635e-02, PNorm = 34.6986, GNorm = 0.5126, lr_0 = 2.1742e-04
Loss = 7.0436e-02, PNorm = 34.7034, GNorm = 0.3359, lr_0 = 2.0771e-04
Loss = 5.9164e-02, PNorm = 34.7037, GNorm = 0.3711, lr_0 = 2.0676e-04
Validation rmse = 1.467548
Epoch 20
Loss = 7.2610e-02, PNorm = 34.7115, GNorm = 0.4188, lr_0 = 1.9753e-04
Validation rmse = 1.295973
Epoch 21
Loss = 6.6445e-02, PNorm = 34.7166, GNorm = 1.0391, lr_0 = 1.8785e-04
Loss = 7.0369e-02, PNorm = 34.7222, GNorm = 0.5574, lr_0 = 1.7946e-04
Validation rmse = 1.394580
Epoch 22
Loss = 6.9981e-02, PNorm = 34.7279, GNorm = 0.4057, lr_0 = 1.7066e-04
Loss = 6.3330e-02, PNorm = 34.7318, GNorm = 0.9102, lr_0 = 1.6304e-04
Validation rmse = 1.343498
Epoch 23
Loss = 6.4334e-02, PNorm = 34.7379, GNorm = 0.3468, lr_0 = 1.5505e-04
Loss = 6.3943e-02, PNorm = 34.7427, GNorm = 0.9586, lr_0 = 1.4813e-04
Validation rmse = 1.298046
Epoch 24
Loss = 6.4753e-02, PNorm = 34.7490, GNorm = 1.1072, lr_0 = 1.4087e-04
Loss = 6.9942e-02, PNorm = 34.7527, GNorm = 0.3769, lr_0 = 1.3458e-04
Validation rmse = 1.389184
Epoch 25
Loss = 6.6627e-02, PNorm = 34.7565, GNorm = 0.6508, lr_0 = 1.2857e-04
Validation rmse = 1.215230
Epoch 26
Loss = 6.7428e-02, PNorm = 34.7610, GNorm = 0.6042, lr_0 = 1.2226e-04
Loss = 5.8487e-02, PNorm = 34.7651, GNorm = 0.4550, lr_0 = 1.1680e-04
Validation rmse = 1.301765
Epoch 27
Loss = 5.3926e-02, PNorm = 34.7690, GNorm = 0.2750, lr_0 = 1.1108e-04
Loss = 5.9385e-02, PNorm = 34.7726, GNorm = 0.5340, lr_0 = 1.0612e-04
Validation rmse = 1.238541
Epoch 28
Loss = 8.1252e-02, PNorm = 34.7774, GNorm = 0.6383, lr_0 = 1.0092e-04
Loss = 7.1939e-02, PNorm = 34.7805, GNorm = 0.4313, lr_0 = 1.0000e-04
Validation rmse = 1.540681
Epoch 29
Loss = 6.2012e-02, PNorm = 34.7835, GNorm = 0.6264, lr_0 = 1.0000e-04
Loss = 6.7318e-02, PNorm = 34.7859, GNorm = 1.6211, lr_0 = 1.0000e-04
Validation rmse = 1.254922
Model 0 best validation rmse = 1.215230 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 1.386643
Ensemble test rmse = 1.386643
1-fold cross validation
	Seed 0 ==> test rmse = 1.386643
Overall test rmse = 1.386643 +/- 0.000000
Elapsed time = 0:00:34
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility', 'logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 2
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 1.5864e-01, PNorm = 34.0649, GNorm = 0.4707, lr_0 = 3.7500e-04
Validation rmse = 3.634560
Epoch 1
Loss = 9.3856e-02, PNorm = 34.0727, GNorm = 0.2594, lr_0 = 6.5000e-04
Loss = 8.8616e-02, PNorm = 34.0957, GNorm = 0.1817, lr_0 = 9.0000e-04
Validation rmse = 2.825121
Epoch 2
Loss = 7.0664e-02, PNorm = 34.1406, GNorm = 0.5865, lr_0 = 9.6853e-04
Loss = 7.3914e-02, PNorm = 34.1830, GNorm = 0.4287, lr_0 = 9.2527e-04
Validation rmse = 2.638363
Epoch 3
Loss = 6.5585e-02, PNorm = 34.2194, GNorm = 0.1876, lr_0 = 8.7992e-04
Loss = 6.3638e-02, PNorm = 34.2529, GNorm = 0.2476, lr_0 = 8.4063e-04
Validation rmse = 2.237671
Epoch 4
Loss = 5.6732e-02, PNorm = 34.2822, GNorm = 0.1492, lr_0 = 7.9943e-04
Loss = 5.8853e-02, PNorm = 34.3082, GNorm = 0.2820, lr_0 = 7.6372e-04
Loss = 5.4987e-02, PNorm = 34.3104, GNorm = 0.2263, lr_0 = 7.6024e-04
Validation rmse = 2.441414
Epoch 5
Loss = 6.4851e-02, PNorm = 34.3353, GNorm = 0.4597, lr_0 = 7.2629e-04
Validation rmse = 2.200688
Epoch 6
Loss = 4.9199e-02, PNorm = 34.3579, GNorm = 0.1238, lr_0 = 6.9069e-04
Loss = 5.3583e-02, PNorm = 34.3816, GNorm = 0.3486, lr_0 = 6.5985e-04
Validation rmse = 2.112452
Epoch 7
Loss = 5.2977e-02, PNorm = 34.3989, GNorm = 0.3520, lr_0 = 6.2751e-04
Loss = 4.7350e-02, PNorm = 34.4254, GNorm = 0.4426, lr_0 = 5.9948e-04
Validation rmse = 1.798057
Epoch 8
Loss = 5.1888e-02, PNorm = 34.4487, GNorm = 1.1852, lr_0 = 5.7010e-04
Loss = 4.8279e-02, PNorm = 34.4685, GNorm = 0.4258, lr_0 = 5.4464e-04
Validation rmse = 2.258354
Epoch 9
Loss = 7.2904e-02, PNorm = 34.4935, GNorm = 0.2416, lr_0 = 5.1795e-04
Loss = 7.2193e-02, PNorm = 34.5152, GNorm = 0.2144, lr_0 = 4.9482e-04
Loss = 6.5689e-02, PNorm = 34.5168, GNorm = 0.2724, lr_0 = 4.9256e-04
Validation rmse = 2.570407
Epoch 10
Loss = 5.2533e-02, PNorm = 34.5385, GNorm = 0.2864, lr_0 = 4.7056e-04
Validation rmse = 1.976332
Epoch 11
Loss = 6.0085e-02, PNorm = 34.5631, GNorm = 1.0166, lr_0 = 4.4750e-04
Loss = 4.9538e-02, PNorm = 34.5748, GNorm = 0.1923, lr_0 = 4.2752e-04
Validation rmse = 1.619796
Epoch 12
Loss = 5.2419e-02, PNorm = 34.5882, GNorm = 1.1132, lr_0 = 4.0656e-04
Loss = 5.5233e-02, PNorm = 34.6034, GNorm = 0.1951, lr_0 = 3.8841e-04
Validation rmse = 2.010288
Epoch 13
Loss = 4.8412e-02, PNorm = 34.6161, GNorm = 0.5450, lr_0 = 3.6937e-04
Loss = 4.5848e-02, PNorm = 34.6302, GNorm = 0.2229, lr_0 = 3.5287e-04
Validation rmse = 1.819283
Epoch 14
Loss = 4.3373e-02, PNorm = 34.6450, GNorm = 0.1773, lr_0 = 3.3558e-04
Loss = 4.1085e-02, PNorm = 34.6566, GNorm = 0.3487, lr_0 = 3.2059e-04
Loss = 7.4645e-02, PNorm = 34.6576, GNorm = 2.9267, lr_0 = 3.1913e-04
Validation rmse = 1.644787
Epoch 15
Loss = 4.6130e-02, PNorm = 34.6646, GNorm = 0.1149, lr_0 = 3.0488e-04
Validation rmse = 1.789243
Epoch 16
Loss = 4.2403e-02, PNorm = 34.6754, GNorm = 0.1436, lr_0 = 2.8994e-04
Loss = 4.1271e-02, PNorm = 34.6865, GNorm = 0.2410, lr_0 = 2.7699e-04
Validation rmse = 1.478478
Epoch 17
Loss = 3.5481e-02, PNorm = 34.6928, GNorm = 0.5277, lr_0 = 2.6341e-04
Loss = 3.6108e-02, PNorm = 34.6996, GNorm = 0.3165, lr_0 = 2.5165e-04
Validation rmse = 1.589332
Epoch 18
Loss = 4.9217e-02, PNorm = 34.7096, GNorm = 0.5339, lr_0 = 2.3931e-04
Loss = 4.5326e-02, PNorm = 34.7182, GNorm = 1.0030, lr_0 = 2.2863e-04
Validation rmse = 1.736512
Epoch 19
Loss = 4.1585e-02, PNorm = 34.7251, GNorm = 0.4082, lr_0 = 2.1742e-04
Loss = 3.3877e-02, PNorm = 34.7307, GNorm = 0.2415, lr_0 = 2.0771e-04
Loss = 3.6929e-02, PNorm = 34.7313, GNorm = 2.7655, lr_0 = 2.0676e-04
Validation rmse = 1.489025
Epoch 20
Loss = 3.7971e-02, PNorm = 34.7384, GNorm = 0.2196, lr_0 = 1.9753e-04
Validation rmse = 1.462978
Epoch 21
Loss = 3.4046e-02, PNorm = 34.7437, GNorm = 0.1854, lr_0 = 1.8785e-04
Loss = 3.7516e-02, PNorm = 34.7496, GNorm = 0.7875, lr_0 = 1.7946e-04
Validation rmse = 1.388371
Epoch 22
Loss = 3.8529e-02, PNorm = 34.7561, GNorm = 0.1448, lr_0 = 1.7066e-04
Loss = 3.3082e-02, PNorm = 34.7622, GNorm = 0.7958, lr_0 = 1.6304e-04
Validation rmse = 1.370124
Epoch 23
Loss = 3.3635e-02, PNorm = 34.7682, GNorm = 0.2388, lr_0 = 1.5505e-04
Loss = 3.2939e-02, PNorm = 34.7728, GNorm = 1.0155, lr_0 = 1.4813e-04
Validation rmse = 1.344323
Epoch 24
Loss = 3.3856e-02, PNorm = 34.7788, GNorm = 0.5582, lr_0 = 1.4087e-04
Loss = 3.4640e-02, PNorm = 34.7822, GNorm = 0.1615, lr_0 = 1.3458e-04
Validation rmse = 1.378771
Epoch 25
Loss = 3.3956e-02, PNorm = 34.7868, GNorm = 0.7298, lr_0 = 1.2857e-04
Validation rmse = 1.293948
Epoch 26
Loss = 3.7140e-02, PNorm = 34.7897, GNorm = 0.6996, lr_0 = 1.2226e-04
Loss = 3.0610e-02, PNorm = 34.7945, GNorm = 0.1908, lr_0 = 1.1680e-04
Validation rmse = 1.268660
Epoch 27
Loss = 2.8127e-02, PNorm = 34.7983, GNorm = 0.1317, lr_0 = 1.1108e-04
Loss = 3.0689e-02, PNorm = 34.8022, GNorm = 0.3736, lr_0 = 1.0612e-04
Validation rmse = 1.275330
Epoch 28
Loss = 3.8303e-02, PNorm = 34.8076, GNorm = 0.4245, lr_0 = 1.0092e-04
Loss = 3.5856e-02, PNorm = 34.8115, GNorm = 0.1993, lr_0 = 1.0000e-04
Validation rmse = 1.598283
Epoch 29
Loss = 3.3371e-02, PNorm = 34.8152, GNorm = 0.1479, lr_0 = 1.0000e-04
Loss = 3.3861e-02, PNorm = 34.8177, GNorm = 0.4605, lr_0 = 1.0000e-04
Validation rmse = 1.322092
Model 0 best validation rmse = 1.268660 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 1.418890
Ensemble test rmse = 1.418890
1-fold cross validation
	Seed 0 ==> test rmse = 1.418890
Overall test rmse = 1.418890 +/- 0.000000
Elapsed time = 0:00:27
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility', 'logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 2
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 1.5864e-01, PNorm = 34.0649, GNorm = 0.4707, lr_0 = 3.7500e-04
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility', 'logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 2
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 1.5864e-01, PNorm = 34.0649, GNorm = 0.4707, lr_0 = 3.7500e-04
Validation rmse = 3.634560
Epoch 1
Loss = 9.3856e-02, PNorm = 34.0727, GNorm = 0.2594, lr_0 = 6.5000e-04
Loss = 8.8616e-02, PNorm = 34.0957, GNorm = 0.1817, lr_0 = 9.0000e-04
Validation rmse = 2.825121
Epoch 2
Loss = 7.0664e-02, PNorm = 34.1406, GNorm = 0.5865, lr_0 = 9.6853e-04
Loss = 7.3914e-02, PNorm = 34.1830, GNorm = 0.4287, lr_0 = 9.2527e-04
Validation rmse = 2.638363
Epoch 3
Loss = 6.5585e-02, PNorm = 34.2194, GNorm = 0.1876, lr_0 = 8.7992e-04
Loss = 6.3638e-02, PNorm = 34.2529, GNorm = 0.2476, lr_0 = 8.4063e-04
Validation rmse = 2.237671
Epoch 4
Loss = 5.6732e-02, PNorm = 34.2822, GNorm = 0.1492, lr_0 = 7.9943e-04
Loss = 5.8853e-02, PNorm = 34.3082, GNorm = 0.2820, lr_0 = 7.6372e-04
Loss = 5.4987e-02, PNorm = 34.3104, GNorm = 0.2263, lr_0 = 7.6024e-04
Validation rmse = 2.441414
Epoch 5
Loss = 6.4851e-02, PNorm = 34.3353, GNorm = 0.4597, lr_0 = 7.2629e-04
Validation rmse = 2.200688
Epoch 6
Loss = 4.9199e-02, PNorm = 34.3579, GNorm = 0.1238, lr_0 = 6.9069e-04
Loss = 5.3583e-02, PNorm = 34.3816, GNorm = 0.3486, lr_0 = 6.5985e-04
Validation rmse = 2.112452
Epoch 7
Loss = 5.2977e-02, PNorm = 34.3989, GNorm = 0.3520, lr_0 = 6.2751e-04
Loss = 4.7350e-02, PNorm = 34.4254, GNorm = 0.4426, lr_0 = 5.9948e-04
Validation rmse = 1.798057
Epoch 8
Loss = 5.1888e-02, PNorm = 34.4487, GNorm = 1.1852, lr_0 = 5.7010e-04
Loss = 4.8279e-02, PNorm = 34.4685, GNorm = 0.4258, lr_0 = 5.4464e-04
Validation rmse = 2.258354
Epoch 9
Loss = 7.2904e-02, PNorm = 34.4935, GNorm = 0.2416, lr_0 = 5.1795e-04
Loss = 7.2193e-02, PNorm = 34.5152, GNorm = 0.2144, lr_0 = 4.9482e-04
Loss = 6.5689e-02, PNorm = 34.5168, GNorm = 0.2724, lr_0 = 4.9256e-04
Validation rmse = 2.570407
Epoch 10
Loss = 5.2533e-02, PNorm = 34.5385, GNorm = 0.2864, lr_0 = 4.7056e-04
Validation rmse = 1.976332
Epoch 11
Loss = 6.0085e-02, PNorm = 34.5631, GNorm = 1.0166, lr_0 = 4.4750e-04
Loss = 4.9538e-02, PNorm = 34.5748, GNorm = 0.1923, lr_0 = 4.2752e-04
Validation rmse = 1.619796
Epoch 12
Loss = 5.2419e-02, PNorm = 34.5882, GNorm = 1.1132, lr_0 = 4.0656e-04
Loss = 5.5233e-02, PNorm = 34.6034, GNorm = 0.1951, lr_0 = 3.8841e-04
Validation rmse = 2.010288
Epoch 13
Loss = 4.8412e-02, PNorm = 34.6161, GNorm = 0.5450, lr_0 = 3.6937e-04
Loss = 4.5848e-02, PNorm = 34.6302, GNorm = 0.2229, lr_0 = 3.5287e-04
Validation rmse = 1.819283
Epoch 14
Loss = 4.3373e-02, PNorm = 34.6450, GNorm = 0.1773, lr_0 = 3.3558e-04
Loss = 4.1085e-02, PNorm = 34.6566, GNorm = 0.3487, lr_0 = 3.2059e-04
Loss = 7.4645e-02, PNorm = 34.6576, GNorm = 2.9267, lr_0 = 3.1913e-04
Validation rmse = 1.644787
Epoch 15
Loss = 4.6130e-02, PNorm = 34.6646, GNorm = 0.1149, lr_0 = 3.0488e-04
Validation rmse = 1.789243
Epoch 16
Loss = 4.2403e-02, PNorm = 34.6754, GNorm = 0.1436, lr_0 = 2.8994e-04
Loss = 4.1271e-02, PNorm = 34.6865, GNorm = 0.2410, lr_0 = 2.7699e-04
Validation rmse = 1.478478
Epoch 17
Loss = 3.5481e-02, PNorm = 34.6928, GNorm = 0.5277, lr_0 = 2.6341e-04
Loss = 3.6108e-02, PNorm = 34.6996, GNorm = 0.3165, lr_0 = 2.5165e-04
Validation rmse = 1.589332
Epoch 18
Loss = 4.9217e-02, PNorm = 34.7096, GNorm = 0.5339, lr_0 = 2.3931e-04
Loss = 4.5326e-02, PNorm = 34.7182, GNorm = 1.0030, lr_0 = 2.2863e-04
Validation rmse = 1.736512
Epoch 19
Loss = 4.1585e-02, PNorm = 34.7251, GNorm = 0.4082, lr_0 = 2.1742e-04
Loss = 3.3877e-02, PNorm = 34.7307, GNorm = 0.2415, lr_0 = 2.0771e-04
Loss = 3.6929e-02, PNorm = 34.7313, GNorm = 2.7655, lr_0 = 2.0676e-04
Validation rmse = 1.489025
Epoch 20
Loss = 3.7971e-02, PNorm = 34.7384, GNorm = 0.2196, lr_0 = 1.9753e-04
Validation rmse = 1.462978
Epoch 21
Loss = 3.4046e-02, PNorm = 34.7437, GNorm = 0.1854, lr_0 = 1.8785e-04
Loss = 3.7516e-02, PNorm = 34.7496, GNorm = 0.7875, lr_0 = 1.7946e-04
Validation rmse = 1.388371
Epoch 22
Loss = 3.8529e-02, PNorm = 34.7561, GNorm = 0.1448, lr_0 = 1.7066e-04
Loss = 3.3082e-02, PNorm = 34.7622, GNorm = 0.7958, lr_0 = 1.6304e-04
Validation rmse = 1.370124
Epoch 23
Loss = 3.3635e-02, PNorm = 34.7682, GNorm = 0.2388, lr_0 = 1.5505e-04
Loss = 3.2939e-02, PNorm = 34.7728, GNorm = 1.0155, lr_0 = 1.4813e-04
Validation rmse = 1.344323
Epoch 24
Loss = 3.3856e-02, PNorm = 34.7788, GNorm = 0.5582, lr_0 = 1.4087e-04
Loss = 3.4640e-02, PNorm = 34.7822, GNorm = 0.1615, lr_0 = 1.3458e-04
Validation rmse = 1.378771
Epoch 25
Loss = 3.3956e-02, PNorm = 34.7868, GNorm = 0.7298, lr_0 = 1.2857e-04
Validation rmse = 1.293948
Epoch 26
Loss = 3.7140e-02, PNorm = 34.7897, GNorm = 0.6996, lr_0 = 1.2226e-04
Loss = 3.0610e-02, PNorm = 34.7945, GNorm = 0.1908, lr_0 = 1.1680e-04
Validation rmse = 1.268660
Epoch 27
Loss = 2.8127e-02, PNorm = 34.7983, GNorm = 0.1317, lr_0 = 1.1108e-04
Loss = 3.0689e-02, PNorm = 34.8022, GNorm = 0.3736, lr_0 = 1.0612e-04
Validation rmse = 1.275330
Epoch 28
Loss = 3.8303e-02, PNorm = 34.8076, GNorm = 0.4245, lr_0 = 1.0092e-04
Loss = 3.5856e-02, PNorm = 34.8115, GNorm = 0.1993, lr_0 = 1.0000e-04
Validation rmse = 1.598283
Epoch 29
Loss = 3.3371e-02, PNorm = 34.8152, GNorm = 0.1479, lr_0 = 1.0000e-04
Loss = 3.3861e-02, PNorm = 34.8177, GNorm = 0.4605, lr_0 = 1.0000e-04
Validation rmse = 1.322092
Model 0 best validation rmse = 1.268660 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 1.418890
Ensemble test rmse = 1.418890
1-fold cross validation
	Seed 0 ==> test rmse = 1.418890
Overall test rmse = 1.418890 +/- 0.000000
Elapsed time = 0:00:31
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility', 'logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 2
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 1.5864e-01, PNorm = 34.0649, GNorm = 0.4707, lr_0 = 3.7500e-04
Validation rmse = 3.634560
Epoch 1
Loss = 9.3856e-02, PNorm = 34.0727, GNorm = 0.2594, lr_0 = 6.5000e-04
Loss = 8.8616e-02, PNorm = 34.0957, GNorm = 0.1817, lr_0 = 9.0000e-04
Validation rmse = 2.825121
Epoch 2
Loss = 7.0664e-02, PNorm = 34.1406, GNorm = 0.5865, lr_0 = 9.6853e-04
Loss = 7.3914e-02, PNorm = 34.1830, GNorm = 0.4287, lr_0 = 9.2527e-04
Validation rmse = 2.638363
Epoch 3
Loss = 6.5585e-02, PNorm = 34.2194, GNorm = 0.1876, lr_0 = 8.7992e-04
Loss = 6.3638e-02, PNorm = 34.2529, GNorm = 0.2476, lr_0 = 8.4063e-04
Validation rmse = 2.237671
Epoch 4
Loss = 5.6732e-02, PNorm = 34.2822, GNorm = 0.1492, lr_0 = 7.9943e-04
Loss = 5.8853e-02, PNorm = 34.3082, GNorm = 0.2820, lr_0 = 7.6372e-04
Loss = 5.4987e-02, PNorm = 34.3104, GNorm = 0.2263, lr_0 = 7.6024e-04
Validation rmse = 2.441414
Epoch 5
Loss = 6.4851e-02, PNorm = 34.3353, GNorm = 0.4597, lr_0 = 7.2629e-04
Validation rmse = 2.200688
Epoch 6
Loss = 4.9199e-02, PNorm = 34.3579, GNorm = 0.1238, lr_0 = 6.9069e-04
Loss = 5.3583e-02, PNorm = 34.3816, GNorm = 0.3486, lr_0 = 6.5985e-04
Validation rmse = 2.112452
Epoch 7
Loss = 5.2977e-02, PNorm = 34.3989, GNorm = 0.3520, lr_0 = 6.2751e-04
Loss = 4.7350e-02, PNorm = 34.4254, GNorm = 0.4426, lr_0 = 5.9948e-04
Validation rmse = 1.798057
Epoch 8
Loss = 5.1888e-02, PNorm = 34.4487, GNorm = 1.1852, lr_0 = 5.7010e-04
Loss = 4.8279e-02, PNorm = 34.4685, GNorm = 0.4258, lr_0 = 5.4464e-04
Validation rmse = 2.258354
Epoch 9
Loss = 7.2904e-02, PNorm = 34.4935, GNorm = 0.2416, lr_0 = 5.1795e-04
Loss = 7.2193e-02, PNorm = 34.5152, GNorm = 0.2144, lr_0 = 4.9482e-04
Loss = 6.5689e-02, PNorm = 34.5168, GNorm = 0.2724, lr_0 = 4.9256e-04
Validation rmse = 2.570407
Epoch 10
Loss = 5.2533e-02, PNorm = 34.5385, GNorm = 0.2864, lr_0 = 4.7056e-04
Validation rmse = 1.976332
Epoch 11
Loss = 6.0085e-02, PNorm = 34.5631, GNorm = 1.0166, lr_0 = 4.4750e-04
Loss = 4.9538e-02, PNorm = 34.5748, GNorm = 0.1923, lr_0 = 4.2752e-04
Validation rmse = 1.619796
Epoch 12
Loss = 5.2419e-02, PNorm = 34.5882, GNorm = 1.1132, lr_0 = 4.0656e-04
Loss = 5.5233e-02, PNorm = 34.6034, GNorm = 0.1951, lr_0 = 3.8841e-04
Validation rmse = 2.010288
Epoch 13
Loss = 4.8412e-02, PNorm = 34.6161, GNorm = 0.5450, lr_0 = 3.6937e-04
Loss = 4.5848e-02, PNorm = 34.6302, GNorm = 0.2229, lr_0 = 3.5287e-04
Validation rmse = 1.819283
Epoch 14
Loss = 4.3373e-02, PNorm = 34.6450, GNorm = 0.1773, lr_0 = 3.3558e-04
Loss = 4.1085e-02, PNorm = 34.6566, GNorm = 0.3487, lr_0 = 3.2059e-04
Loss = 7.4645e-02, PNorm = 34.6576, GNorm = 2.9267, lr_0 = 3.1913e-04
Validation rmse = 1.644787
Epoch 15
Loss = 4.6130e-02, PNorm = 34.6646, GNorm = 0.1149, lr_0 = 3.0488e-04
Validation rmse = 1.789243
Epoch 16
Loss = 4.2403e-02, PNorm = 34.6754, GNorm = 0.1436, lr_0 = 2.8994e-04
Loss = 4.1271e-02, PNorm = 34.6865, GNorm = 0.2410, lr_0 = 2.7699e-04
Validation rmse = 1.478478
Epoch 17
Loss = 3.5481e-02, PNorm = 34.6928, GNorm = 0.5277, lr_0 = 2.6341e-04
Loss = 3.6108e-02, PNorm = 34.6996, GNorm = 0.3165, lr_0 = 2.5165e-04
Validation rmse = 1.589332
Epoch 18
Loss = 4.9217e-02, PNorm = 34.7096, GNorm = 0.5339, lr_0 = 2.3931e-04
Loss = 4.5326e-02, PNorm = 34.7182, GNorm = 1.0030, lr_0 = 2.2863e-04
Validation rmse = 1.736512
Epoch 19
Loss = 4.1585e-02, PNorm = 34.7251, GNorm = 0.4082, lr_0 = 2.1742e-04
Loss = 3.3877e-02, PNorm = 34.7307, GNorm = 0.2415, lr_0 = 2.0771e-04
Loss = 3.6929e-02, PNorm = 34.7313, GNorm = 2.7655, lr_0 = 2.0676e-04
Validation rmse = 1.489025
Epoch 20
Loss = 3.7971e-02, PNorm = 34.7384, GNorm = 0.2196, lr_0 = 1.9753e-04
Validation rmse = 1.462978
Epoch 21
Loss = 3.4046e-02, PNorm = 34.7437, GNorm = 0.1854, lr_0 = 1.8785e-04
Loss = 3.7516e-02, PNorm = 34.7496, GNorm = 0.7875, lr_0 = 1.7946e-04
Validation rmse = 1.388371
Epoch 22
Loss = 3.8529e-02, PNorm = 34.7561, GNorm = 0.1448, lr_0 = 1.7066e-04
Loss = 3.3082e-02, PNorm = 34.7622, GNorm = 0.7958, lr_0 = 1.6304e-04
Validation rmse = 1.370124
Epoch 23
Loss = 3.3635e-02, PNorm = 34.7682, GNorm = 0.2388, lr_0 = 1.5505e-04
Loss = 3.2939e-02, PNorm = 34.7728, GNorm = 1.0155, lr_0 = 1.4813e-04
Validation rmse = 1.344323
Epoch 24
Loss = 3.3856e-02, PNorm = 34.7788, GNorm = 0.5582, lr_0 = 1.4087e-04
Loss = 3.4640e-02, PNorm = 34.7822, GNorm = 0.1615, lr_0 = 1.3458e-04
Validation rmse = 1.378771
Epoch 25
Loss = 3.3956e-02, PNorm = 34.7868, GNorm = 0.7298, lr_0 = 1.2857e-04
Validation rmse = 1.293948
Epoch 26
Loss = 3.7140e-02, PNorm = 34.7897, GNorm = 0.6996, lr_0 = 1.2226e-04
Loss = 3.0610e-02, PNorm = 34.7945, GNorm = 0.1908, lr_0 = 1.1680e-04
Validation rmse = 1.268660
Epoch 27
Loss = 2.8127e-02, PNorm = 34.7983, GNorm = 0.1317, lr_0 = 1.1108e-04
Loss = 3.0689e-02, PNorm = 34.8022, GNorm = 0.3736, lr_0 = 1.0612e-04
Validation rmse = 1.275330
Epoch 28
Loss = 3.8303e-02, PNorm = 34.8076, GNorm = 0.4245, lr_0 = 1.0092e-04
Loss = 3.5856e-02, PNorm = 34.8115, GNorm = 0.1993, lr_0 = 1.0000e-04
Validation rmse = 1.598283
Epoch 29
Loss = 3.3371e-02, PNorm = 34.8152, GNorm = 0.1479, lr_0 = 1.0000e-04
Loss = 3.3861e-02, PNorm = 34.8177, GNorm = 0.4605, lr_0 = 1.0000e-04
Validation rmse = 1.322092
Model 0 best validation rmse = 1.268660 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 1.418890
Ensemble test rmse = 1.418890
1-fold cross validation
	Seed 0 ==> test rmse = 1.418890
Overall test rmse = 1.418890 +/- 0.000000
Elapsed time = 0:00:33
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility', 'logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 2
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 1.5864e-01, PNorm = 34.0649, GNorm = 0.4707, lr_0 = 3.7500e-04
Validation rmse = 3.634560
Epoch 1
Loss = 9.3856e-02, PNorm = 34.0727, GNorm = 0.2594, lr_0 = 6.5000e-04
Loss = 8.8616e-02, PNorm = 34.0957, GNorm = 0.1817, lr_0 = 9.0000e-04
Validation rmse = 2.825121
Epoch 2
Loss = 7.0664e-02, PNorm = 34.1406, GNorm = 0.5865, lr_0 = 9.6853e-04
Loss = 7.3914e-02, PNorm = 34.1830, GNorm = 0.4287, lr_0 = 9.2527e-04
Validation rmse = 2.638363
Epoch 3
Loss = 6.5585e-02, PNorm = 34.2194, GNorm = 0.1876, lr_0 = 8.7992e-04
Loss = 6.3638e-02, PNorm = 34.2529, GNorm = 0.2476, lr_0 = 8.4063e-04
Validation rmse = 2.237671
Epoch 4
Loss = 5.6732e-02, PNorm = 34.2822, GNorm = 0.1492, lr_0 = 7.9943e-04
Loss = 5.8853e-02, PNorm = 34.3082, GNorm = 0.2820, lr_0 = 7.6372e-04
Loss = 5.4987e-02, PNorm = 34.3104, GNorm = 0.2263, lr_0 = 7.6024e-04
Validation rmse = 2.441414
Epoch 5
Loss = 6.4851e-02, PNorm = 34.3353, GNorm = 0.4597, lr_0 = 7.2629e-04
Validation rmse = 2.200688
Epoch 6
Loss = 4.9199e-02, PNorm = 34.3579, GNorm = 0.1238, lr_0 = 6.9069e-04
Loss = 5.3583e-02, PNorm = 34.3816, GNorm = 0.3486, lr_0 = 6.5985e-04
Validation rmse = 2.112452
Epoch 7
Loss = 5.2977e-02, PNorm = 34.3989, GNorm = 0.3520, lr_0 = 6.2751e-04
Loss = 4.7350e-02, PNorm = 34.4254, GNorm = 0.4426, lr_0 = 5.9948e-04
Validation rmse = 1.798057
Epoch 8
Loss = 5.1888e-02, PNorm = 34.4487, GNorm = 1.1852, lr_0 = 5.7010e-04
Loss = 4.8279e-02, PNorm = 34.4685, GNorm = 0.4258, lr_0 = 5.4464e-04
Validation rmse = 2.258354
Epoch 9
Loss = 7.2904e-02, PNorm = 34.4935, GNorm = 0.2416, lr_0 = 5.1795e-04
Loss = 7.2193e-02, PNorm = 34.5152, GNorm = 0.2144, lr_0 = 4.9482e-04
Loss = 6.5689e-02, PNorm = 34.5168, GNorm = 0.2724, lr_0 = 4.9256e-04
Validation rmse = 2.570407
Epoch 10
Loss = 5.2533e-02, PNorm = 34.5385, GNorm = 0.2864, lr_0 = 4.7056e-04
Validation rmse = 1.976332
Epoch 11
Loss = 6.0085e-02, PNorm = 34.5631, GNorm = 1.0166, lr_0 = 4.4750e-04
Loss = 4.9538e-02, PNorm = 34.5748, GNorm = 0.1923, lr_0 = 4.2752e-04
Validation rmse = 1.619796
Epoch 12
Loss = 5.2419e-02, PNorm = 34.5882, GNorm = 1.1132, lr_0 = 4.0656e-04
Loss = 5.5233e-02, PNorm = 34.6034, GNorm = 0.1951, lr_0 = 3.8841e-04
Validation rmse = 2.010288
Epoch 13
Loss = 4.8412e-02, PNorm = 34.6161, GNorm = 0.5450, lr_0 = 3.6937e-04
Loss = 4.5848e-02, PNorm = 34.6302, GNorm = 0.2229, lr_0 = 3.5287e-04
Validation rmse = 1.819283
Epoch 14
Loss = 4.3373e-02, PNorm = 34.6450, GNorm = 0.1773, lr_0 = 3.3558e-04
Loss = 4.1085e-02, PNorm = 34.6566, GNorm = 0.3487, lr_0 = 3.2059e-04
Loss = 7.4645e-02, PNorm = 34.6576, GNorm = 2.9267, lr_0 = 3.1913e-04
Validation rmse = 1.644787
Epoch 15
Loss = 4.6130e-02, PNorm = 34.6646, GNorm = 0.1149, lr_0 = 3.0488e-04
Validation rmse = 1.789243
Epoch 16
Loss = 4.2403e-02, PNorm = 34.6754, GNorm = 0.1436, lr_0 = 2.8994e-04
Loss = 4.1271e-02, PNorm = 34.6865, GNorm = 0.2410, lr_0 = 2.7699e-04
Validation rmse = 1.478478
Epoch 17
Loss = 3.5481e-02, PNorm = 34.6928, GNorm = 0.5277, lr_0 = 2.6341e-04
Loss = 3.6108e-02, PNorm = 34.6996, GNorm = 0.3165, lr_0 = 2.5165e-04
Validation rmse = 1.589332
Epoch 18
Loss = 4.9217e-02, PNorm = 34.7096, GNorm = 0.5339, lr_0 = 2.3931e-04
Loss = 4.5326e-02, PNorm = 34.7182, GNorm = 1.0030, lr_0 = 2.2863e-04
Validation rmse = 1.736512
Epoch 19
Loss = 4.1585e-02, PNorm = 34.7251, GNorm = 0.4082, lr_0 = 2.1742e-04
Loss = 3.3877e-02, PNorm = 34.7307, GNorm = 0.2415, lr_0 = 2.0771e-04
Loss = 3.6929e-02, PNorm = 34.7313, GNorm = 2.7655, lr_0 = 2.0676e-04
Validation rmse = 1.489025
Epoch 20
Loss = 3.7971e-02, PNorm = 34.7384, GNorm = 0.2196, lr_0 = 1.9753e-04
Validation rmse = 1.462978
Epoch 21
Loss = 3.4046e-02, PNorm = 34.7437, GNorm = 0.1854, lr_0 = 1.8785e-04
Loss = 3.7516e-02, PNorm = 34.7496, GNorm = 0.7875, lr_0 = 1.7946e-04
Validation rmse = 1.388371
Epoch 22
Loss = 3.8529e-02, PNorm = 34.7561, GNorm = 0.1448, lr_0 = 1.7066e-04
Loss = 3.3082e-02, PNorm = 34.7622, GNorm = 0.7958, lr_0 = 1.6304e-04
Validation rmse = 1.370124
Epoch 23
Loss = 3.3635e-02, PNorm = 34.7682, GNorm = 0.2388, lr_0 = 1.5505e-04
Loss = 3.2939e-02, PNorm = 34.7728, GNorm = 1.0155, lr_0 = 1.4813e-04
Validation rmse = 1.344323
Epoch 24
Loss = 3.3856e-02, PNorm = 34.7788, GNorm = 0.5582, lr_0 = 1.4087e-04
Loss = 3.4640e-02, PNorm = 34.7822, GNorm = 0.1615, lr_0 = 1.3458e-04
Validation rmse = 1.378771
Epoch 25
Loss = 3.3956e-02, PNorm = 34.7868, GNorm = 0.7298, lr_0 = 1.2857e-04
Validation rmse = 1.293948
Epoch 26
Loss = 3.7140e-02, PNorm = 34.7897, GNorm = 0.6996, lr_0 = 1.2226e-04
Loss = 3.0610e-02, PNorm = 34.7945, GNorm = 0.1908, lr_0 = 1.1680e-04
Validation rmse = 1.268660
Epoch 27
Loss = 2.8127e-02, PNorm = 34.7983, GNorm = 0.1317, lr_0 = 1.1108e-04
Loss = 3.0689e-02, PNorm = 34.8022, GNorm = 0.3736, lr_0 = 1.0612e-04
Validation rmse = 1.275330
Epoch 28
Loss = 3.8303e-02, PNorm = 34.8076, GNorm = 0.4245, lr_0 = 1.0092e-04
Loss = 3.5856e-02, PNorm = 34.8115, GNorm = 0.1993, lr_0 = 1.0000e-04
Validation rmse = 1.598283
Epoch 29
Loss = 3.3371e-02, PNorm = 34.8152, GNorm = 0.1479, lr_0 = 1.0000e-04
Loss = 3.3861e-02, PNorm = 34.8177, GNorm = 0.4605, lr_0 = 1.0000e-04
Validation rmse = 1.322092
Model 0 best validation rmse = 1.268660 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 1.418890
Ensemble test rmse = 1.418890
1-fold cross validation
	Seed 0 ==> test rmse = 1.418890
Overall test rmse = 1.418890 +/- 0.000000
Elapsed time = 0:00:33
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quantiles': [0.05, 0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility', 'logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 2
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quantiles': [0.05, 0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility', 'logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 2
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quantiles': [0.05, 0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility', 'logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 2
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quantiles': [0.05, 0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility', 'logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 2
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 1.5864e-01, PNorm = 34.0649, GNorm = 0.4707, lr_0 = 3.7500e-04
Validation rmse = 3.634560
Epoch 1
Loss = 9.3856e-02, PNorm = 34.0727, GNorm = 0.2594, lr_0 = 6.5000e-04
Loss = 8.8616e-02, PNorm = 34.0957, GNorm = 0.1817, lr_0 = 9.0000e-04
Validation rmse = 2.825121
Epoch 2
Loss = 7.0664e-02, PNorm = 34.1406, GNorm = 0.5865, lr_0 = 9.6853e-04
Loss = 7.3914e-02, PNorm = 34.1830, GNorm = 0.4287, lr_0 = 9.2527e-04
Validation rmse = 2.638363
Epoch 3
Loss = 6.5585e-02, PNorm = 34.2194, GNorm = 0.1876, lr_0 = 8.7992e-04
Loss = 6.3638e-02, PNorm = 34.2529, GNorm = 0.2476, lr_0 = 8.4063e-04
Validation rmse = 2.237671
Epoch 4
Loss = 5.6732e-02, PNorm = 34.2822, GNorm = 0.1492, lr_0 = 7.9943e-04
Loss = 5.8853e-02, PNorm = 34.3082, GNorm = 0.2820, lr_0 = 7.6372e-04
Loss = 5.4987e-02, PNorm = 34.3104, GNorm = 0.2263, lr_0 = 7.6024e-04
Validation rmse = 2.441414
Epoch 5
Loss = 6.4851e-02, PNorm = 34.3353, GNorm = 0.4597, lr_0 = 7.2629e-04
Validation rmse = 2.200688
Epoch 6
Loss = 4.9199e-02, PNorm = 34.3579, GNorm = 0.1238, lr_0 = 6.9069e-04
Loss = 5.3583e-02, PNorm = 34.3816, GNorm = 0.3486, lr_0 = 6.5985e-04
Validation rmse = 2.112452
Epoch 7
Loss = 5.2977e-02, PNorm = 34.3989, GNorm = 0.3520, lr_0 = 6.2751e-04
Loss = 4.7350e-02, PNorm = 34.4254, GNorm = 0.4426, lr_0 = 5.9948e-04
Validation rmse = 1.798057
Epoch 8
Loss = 5.1888e-02, PNorm = 34.4487, GNorm = 1.1852, lr_0 = 5.7010e-04
Loss = 4.8279e-02, PNorm = 34.4685, GNorm = 0.4258, lr_0 = 5.4464e-04
Validation rmse = 2.258354
Epoch 9
Loss = 7.2904e-02, PNorm = 34.4935, GNorm = 0.2416, lr_0 = 5.1795e-04
Loss = 7.2193e-02, PNorm = 34.5152, GNorm = 0.2144, lr_0 = 4.9482e-04
Loss = 6.5689e-02, PNorm = 34.5168, GNorm = 0.2724, lr_0 = 4.9256e-04
Validation rmse = 2.570407
Epoch 10
Loss = 5.2533e-02, PNorm = 34.5385, GNorm = 0.2864, lr_0 = 4.7056e-04
Validation rmse = 1.976332
Epoch 11
Loss = 6.0085e-02, PNorm = 34.5631, GNorm = 1.0166, lr_0 = 4.4750e-04
Loss = 4.9538e-02, PNorm = 34.5748, GNorm = 0.1923, lr_0 = 4.2752e-04
Validation rmse = 1.619796
Epoch 12
Loss = 5.2419e-02, PNorm = 34.5882, GNorm = 1.1132, lr_0 = 4.0656e-04
Loss = 5.5233e-02, PNorm = 34.6034, GNorm = 0.1951, lr_0 = 3.8841e-04
Validation rmse = 2.010288
Epoch 13
Loss = 4.8412e-02, PNorm = 34.6161, GNorm = 0.5450, lr_0 = 3.6937e-04
Loss = 4.5848e-02, PNorm = 34.6302, GNorm = 0.2229, lr_0 = 3.5287e-04
Validation rmse = 1.819283
Epoch 14
Loss = 4.3373e-02, PNorm = 34.6450, GNorm = 0.1773, lr_0 = 3.3558e-04
Loss = 4.1085e-02, PNorm = 34.6566, GNorm = 0.3487, lr_0 = 3.2059e-04
Loss = 7.4645e-02, PNorm = 34.6576, GNorm = 2.9267, lr_0 = 3.1913e-04
Validation rmse = 1.644787
Epoch 15
Loss = 4.6130e-02, PNorm = 34.6646, GNorm = 0.1149, lr_0 = 3.0488e-04
Validation rmse = 1.789243
Epoch 16
Loss = 4.2403e-02, PNorm = 34.6754, GNorm = 0.1436, lr_0 = 2.8994e-04
Loss = 4.1271e-02, PNorm = 34.6865, GNorm = 0.2410, lr_0 = 2.7699e-04
Validation rmse = 1.478478
Epoch 17
Loss = 3.5481e-02, PNorm = 34.6928, GNorm = 0.5277, lr_0 = 2.6341e-04
Loss = 3.6108e-02, PNorm = 34.6996, GNorm = 0.3165, lr_0 = 2.5165e-04
Validation rmse = 1.589332
Epoch 18
Loss = 4.9217e-02, PNorm = 34.7096, GNorm = 0.5339, lr_0 = 2.3931e-04
Loss = 4.5326e-02, PNorm = 34.7182, GNorm = 1.0030, lr_0 = 2.2863e-04
Validation rmse = 1.736512
Epoch 19
Loss = 4.1585e-02, PNorm = 34.7251, GNorm = 0.4082, lr_0 = 2.1742e-04
Loss = 3.3877e-02, PNorm = 34.7307, GNorm = 0.2415, lr_0 = 2.0771e-04
Loss = 3.6929e-02, PNorm = 34.7313, GNorm = 2.7655, lr_0 = 2.0676e-04
Validation rmse = 1.489025
Epoch 20
Loss = 3.7971e-02, PNorm = 34.7384, GNorm = 0.2196, lr_0 = 1.9753e-04
Validation rmse = 1.462978
Epoch 21
Loss = 3.4046e-02, PNorm = 34.7437, GNorm = 0.1854, lr_0 = 1.8785e-04
Loss = 3.7516e-02, PNorm = 34.7496, GNorm = 0.7875, lr_0 = 1.7946e-04
Validation rmse = 1.388371
Epoch 22
Loss = 3.8529e-02, PNorm = 34.7561, GNorm = 0.1448, lr_0 = 1.7066e-04
Loss = 3.3082e-02, PNorm = 34.7622, GNorm = 0.7958, lr_0 = 1.6304e-04
Validation rmse = 1.370124
Epoch 23
Loss = 3.3635e-02, PNorm = 34.7682, GNorm = 0.2388, lr_0 = 1.5505e-04
Loss = 3.2939e-02, PNorm = 34.7728, GNorm = 1.0155, lr_0 = 1.4813e-04
Validation rmse = 1.344323
Epoch 24
Loss = 3.3856e-02, PNorm = 34.7788, GNorm = 0.5582, lr_0 = 1.4087e-04
Loss = 3.4640e-02, PNorm = 34.7822, GNorm = 0.1615, lr_0 = 1.3458e-04
Validation rmse = 1.378771
Epoch 25
Loss = 3.3956e-02, PNorm = 34.7868, GNorm = 0.7298, lr_0 = 1.2857e-04
Validation rmse = 1.293948
Epoch 26
Loss = 3.7140e-02, PNorm = 34.7897, GNorm = 0.6996, lr_0 = 1.2226e-04
Loss = 3.0610e-02, PNorm = 34.7945, GNorm = 0.1908, lr_0 = 1.1680e-04
Validation rmse = 1.268660
Epoch 27
Loss = 2.8127e-02, PNorm = 34.7983, GNorm = 0.1317, lr_0 = 1.1108e-04
Loss = 3.0689e-02, PNorm = 34.8022, GNorm = 0.3736, lr_0 = 1.0612e-04
Validation rmse = 1.275330
Epoch 28
Loss = 3.8303e-02, PNorm = 34.8076, GNorm = 0.4245, lr_0 = 1.0092e-04
Loss = 3.5856e-02, PNorm = 34.8115, GNorm = 0.1993, lr_0 = 1.0000e-04
Validation rmse = 1.598283
Epoch 29
Loss = 3.3371e-02, PNorm = 34.8152, GNorm = 0.1479, lr_0 = 1.0000e-04
Loss = 3.3861e-02, PNorm = 34.8177, GNorm = 0.4605, lr_0 = 1.0000e-04
Validation rmse = 1.322092
Model 0 best validation rmse = 1.268660 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 1.418890
Ensemble test rmse = 1.418890
1-fold cross validation
	Seed 0 ==> test rmse = 1.418890
Overall test rmse = 1.418890 +/- 0.000000
Elapsed time = 0:00:30
Command line
python delaneyTrainQuantileInterval.py
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alpha': 0.1,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': 'data/delaney.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'quantile_interval',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quantile': 0.5,
 'quantiles': [0.05, 0.95],
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'delaney_checkpoints_quantile_interval',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['logSolubility', 'logSolubility'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 2
Fold 0
Splitting data with seed 0
Total size = 1,128 | train size = 902 | val size = 113 | test size = 113
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=2, bias=True)
  )
)
Number of parameters = 355,502
Epoch 0
Loss = 1.5864e-01, PNorm = 34.0649, GNorm = 0.4707, lr_0 = 3.7500e-04
Validation rmse = 3.634560
Epoch 1
Loss = 9.3856e-02, PNorm = 34.0727, GNorm = 0.2594, lr_0 = 6.5000e-04
Loss = 8.8616e-02, PNorm = 34.0957, GNorm = 0.1817, lr_0 = 9.0000e-04
Validation rmse = 2.825121
Epoch 2
Loss = 7.0664e-02, PNorm = 34.1406, GNorm = 0.5865, lr_0 = 9.6853e-04
Loss = 7.3914e-02, PNorm = 34.1830, GNorm = 0.4287, lr_0 = 9.2527e-04
Validation rmse = 2.638363
Epoch 3
Loss = 6.5585e-02, PNorm = 34.2194, GNorm = 0.1876, lr_0 = 8.7992e-04
Loss = 6.3638e-02, PNorm = 34.2529, GNorm = 0.2476, lr_0 = 8.4063e-04
Validation rmse = 2.237671
Epoch 4
Loss = 5.6732e-02, PNorm = 34.2822, GNorm = 0.1492, lr_0 = 7.9943e-04
Loss = 5.8853e-02, PNorm = 34.3082, GNorm = 0.2820, lr_0 = 7.6372e-04
Loss = 5.4987e-02, PNorm = 34.3104, GNorm = 0.2263, lr_0 = 7.6024e-04
Validation rmse = 2.441414
Epoch 5
Loss = 6.4851e-02, PNorm = 34.3353, GNorm = 0.4597, lr_0 = 7.2629e-04
Validation rmse = 2.200688
Epoch 6
Loss = 4.9199e-02, PNorm = 34.3579, GNorm = 0.1238, lr_0 = 6.9069e-04
Loss = 5.3583e-02, PNorm = 34.3816, GNorm = 0.3486, lr_0 = 6.5985e-04
Validation rmse = 2.112452
Epoch 7
Loss = 5.2977e-02, PNorm = 34.3989, GNorm = 0.3520, lr_0 = 6.2751e-04
Loss = 4.7350e-02, PNorm = 34.4254, GNorm = 0.4426, lr_0 = 5.9948e-04
Validation rmse = 1.798057
Epoch 8
Loss = 5.1888e-02, PNorm = 34.4487, GNorm = 1.1852, lr_0 = 5.7010e-04
Loss = 4.8279e-02, PNorm = 34.4685, GNorm = 0.4258, lr_0 = 5.4464e-04
Validation rmse = 2.258354
Epoch 9
Loss = 7.2904e-02, PNorm = 34.4935, GNorm = 0.2416, lr_0 = 5.1795e-04
Loss = 7.2193e-02, PNorm = 34.5152, GNorm = 0.2144, lr_0 = 4.9482e-04
Loss = 6.5689e-02, PNorm = 34.5168, GNorm = 0.2724, lr_0 = 4.9256e-04
Validation rmse = 2.570407
Epoch 10
Loss = 5.2533e-02, PNorm = 34.5385, GNorm = 0.2864, lr_0 = 4.7056e-04
Validation rmse = 1.976332
Epoch 11
Loss = 6.0085e-02, PNorm = 34.5631, GNorm = 1.0166, lr_0 = 4.4750e-04
Loss = 4.9538e-02, PNorm = 34.5748, GNorm = 0.1923, lr_0 = 4.2752e-04
Validation rmse = 1.619796
Epoch 12
Loss = 5.2419e-02, PNorm = 34.5882, GNorm = 1.1132, lr_0 = 4.0656e-04
Loss = 5.5233e-02, PNorm = 34.6034, GNorm = 0.1951, lr_0 = 3.8841e-04
Validation rmse = 2.010288
Epoch 13
Loss = 4.8412e-02, PNorm = 34.6161, GNorm = 0.5450, lr_0 = 3.6937e-04
Loss = 4.5848e-02, PNorm = 34.6302, GNorm = 0.2229, lr_0 = 3.5287e-04
Validation rmse = 1.819283
Epoch 14
Loss = 4.3373e-02, PNorm = 34.6450, GNorm = 0.1773, lr_0 = 3.3558e-04
Loss = 4.1085e-02, PNorm = 34.6566, GNorm = 0.3487, lr_0 = 3.2059e-04
Loss = 7.4645e-02, PNorm = 34.6576, GNorm = 2.9267, lr_0 = 3.1913e-04
Validation rmse = 1.644787
Epoch 15
Loss = 4.6130e-02, PNorm = 34.6646, GNorm = 0.1149, lr_0 = 3.0488e-04
Validation rmse = 1.789243
Epoch 16
Loss = 4.2403e-02, PNorm = 34.6754, GNorm = 0.1436, lr_0 = 2.8994e-04
Loss = 4.1271e-02, PNorm = 34.6865, GNorm = 0.2410, lr_0 = 2.7699e-04
Validation rmse = 1.478478
Epoch 17
Loss = 3.5481e-02, PNorm = 34.6928, GNorm = 0.5277, lr_0 = 2.6341e-04
Loss = 3.6108e-02, PNorm = 34.6996, GNorm = 0.3165, lr_0 = 2.5165e-04
Validation rmse = 1.589332
Epoch 18
Loss = 4.9217e-02, PNorm = 34.7096, GNorm = 0.5339, lr_0 = 2.3931e-04
Loss = 4.5326e-02, PNorm = 34.7182, GNorm = 1.0030, lr_0 = 2.2863e-04
Validation rmse = 1.736512
Epoch 19
Loss = 4.1585e-02, PNorm = 34.7251, GNorm = 0.4082, lr_0 = 2.1742e-04
Loss = 3.3877e-02, PNorm = 34.7307, GNorm = 0.2415, lr_0 = 2.0771e-04
Loss = 3.6929e-02, PNorm = 34.7313, GNorm = 2.7655, lr_0 = 2.0676e-04
Validation rmse = 1.489025
Epoch 20
Loss = 3.7971e-02, PNorm = 34.7384, GNorm = 0.2196, lr_0 = 1.9753e-04
Validation rmse = 1.462978
Epoch 21
Loss = 3.4046e-02, PNorm = 34.7437, GNorm = 0.1854, lr_0 = 1.8785e-04
Loss = 3.7516e-02, PNorm = 34.7496, GNorm = 0.7875, lr_0 = 1.7946e-04
Validation rmse = 1.388371
Epoch 22
Loss = 3.8529e-02, PNorm = 34.7561, GNorm = 0.1448, lr_0 = 1.7066e-04
Loss = 3.3082e-02, PNorm = 34.7622, GNorm = 0.7958, lr_0 = 1.6304e-04
Validation rmse = 1.370124
Epoch 23
Loss = 3.3635e-02, PNorm = 34.7682, GNorm = 0.2388, lr_0 = 1.5505e-04
Loss = 3.2939e-02, PNorm = 34.7728, GNorm = 1.0155, lr_0 = 1.4813e-04
Validation rmse = 1.344323
Epoch 24
Loss = 3.3856e-02, PNorm = 34.7788, GNorm = 0.5582, lr_0 = 1.4087e-04
Loss = 3.4640e-02, PNorm = 34.7822, GNorm = 0.1615, lr_0 = 1.3458e-04
Validation rmse = 1.378771
Epoch 25
Loss = 3.3956e-02, PNorm = 34.7868, GNorm = 0.7298, lr_0 = 1.2857e-04
Validation rmse = 1.293948
Epoch 26
Loss = 3.7140e-02, PNorm = 34.7897, GNorm = 0.6996, lr_0 = 1.2226e-04
Loss = 3.0610e-02, PNorm = 34.7945, GNorm = 0.1908, lr_0 = 1.1680e-04
Validation rmse = 1.268660
Epoch 27
Loss = 2.8127e-02, PNorm = 34.7983, GNorm = 0.1317, lr_0 = 1.1108e-04
Loss = 3.0689e-02, PNorm = 34.8022, GNorm = 0.3736, lr_0 = 1.0612e-04
Validation rmse = 1.275330
Epoch 28
Loss = 3.8303e-02, PNorm = 34.8076, GNorm = 0.4245, lr_0 = 1.0092e-04
Loss = 3.5856e-02, PNorm = 34.8115, GNorm = 0.1993, lr_0 = 1.0000e-04
Validation rmse = 1.598283
Epoch 29
Loss = 3.3371e-02, PNorm = 34.8152, GNorm = 0.1479, lr_0 = 1.0000e-04
Loss = 3.3861e-02, PNorm = 34.8177, GNorm = 0.4605, lr_0 = 1.0000e-04
Validation rmse = 1.322092
Model 0 best validation rmse = 1.268660 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 1.418890
Ensemble test rmse = 1.418890
1-fold cross validation
	Seed 0 ==> test rmse = 1.418890
Overall test rmse = 1.418890 +/- 0.000000
Elapsed time = 0:00:31
